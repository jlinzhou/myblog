<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>23种设计模式简介 | 一朝春诔</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="assets/img/favicon.ico">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-152x152.png">
    <meta name="description" content="一朝春诔的学习笔记">
    <meta name="author" content="一朝春诔">
    <meta name="keywords" content="vuepress介绍，vuepress说明，一朝春诔">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="icons/icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.27faccf6.css" as="style"><link rel="preload" href="/assets/js/app.930ef16c.js" as="script"><link rel="preload" href="/assets/js/6.a4c4b5d6.js" as="script"><link rel="preload" href="/assets/js/2.1492d491.js" as="script"><link rel="preload" href="/assets/js/44.a3029ae5.js" as="script"><link rel="preload" href="/assets/js/3.90399333.js" as="script"><link rel="prefetch" href="/assets/js/10.87145463.js"><link rel="prefetch" href="/assets/js/11.221fba97.js"><link rel="prefetch" href="/assets/js/12.27a5f108.js"><link rel="prefetch" href="/assets/js/13.5621dfa6.js"><link rel="prefetch" href="/assets/js/14.2ec4739f.js"><link rel="prefetch" href="/assets/js/15.7978d65f.js"><link rel="prefetch" href="/assets/js/16.a4bbafb3.js"><link rel="prefetch" href="/assets/js/17.155e45f3.js"><link rel="prefetch" href="/assets/js/18.1e424122.js"><link rel="prefetch" href="/assets/js/19.ba302dd1.js"><link rel="prefetch" href="/assets/js/20.9a4ebae3.js"><link rel="prefetch" href="/assets/js/21.9f481994.js"><link rel="prefetch" href="/assets/js/22.100055d7.js"><link rel="prefetch" href="/assets/js/23.d2447aea.js"><link rel="prefetch" href="/assets/js/24.28bff12b.js"><link rel="prefetch" href="/assets/js/25.3fbec856.js"><link rel="prefetch" href="/assets/js/26.59c4ff75.js"><link rel="prefetch" href="/assets/js/27.9553aeb5.js"><link rel="prefetch" href="/assets/js/28.20bad81c.js"><link rel="prefetch" href="/assets/js/29.b3f96c7b.js"><link rel="prefetch" href="/assets/js/30.85ff35d9.js"><link rel="prefetch" href="/assets/js/31.34457343.js"><link rel="prefetch" href="/assets/js/32.d29e33a7.js"><link rel="prefetch" href="/assets/js/33.7f0bb146.js"><link rel="prefetch" href="/assets/js/34.22f42eb7.js"><link rel="prefetch" href="/assets/js/35.8da0a2e7.js"><link rel="prefetch" href="/assets/js/36.886317b1.js"><link rel="prefetch" href="/assets/js/37.3b7af4a8.js"><link rel="prefetch" href="/assets/js/38.5c38d261.js"><link rel="prefetch" href="/assets/js/39.6e003123.js"><link rel="prefetch" href="/assets/js/4.9afa6061.js"><link rel="prefetch" href="/assets/js/40.ec5c04a8.js"><link rel="prefetch" href="/assets/js/41.a8ace955.js"><link rel="prefetch" href="/assets/js/42.54abc729.js"><link rel="prefetch" href="/assets/js/43.c6d0b564.js"><link rel="prefetch" href="/assets/js/45.09f6dca3.js"><link rel="prefetch" href="/assets/js/46.da2e383b.js"><link rel="prefetch" href="/assets/js/47.63973a6e.js"><link rel="prefetch" href="/assets/js/48.dfd70d39.js"><link rel="prefetch" href="/assets/js/49.54fd64f2.js"><link rel="prefetch" href="/assets/js/5.e99d3266.js"><link rel="prefetch" href="/assets/js/50.a7cbc80a.js"><link rel="prefetch" href="/assets/js/51.0e2ca6d1.js"><link rel="prefetch" href="/assets/js/7.be7c9864.js"><link rel="prefetch" href="/assets/js/8.e855ae57.js"><link rel="prefetch" href="/assets/js/9.a7df38a9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.27faccf6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">一朝春诔</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/golang/" class="nav-link">
  golang
</a></li><li class="dropdown-item"><!----> <a href="/backend/python/" class="nav-link">
  python
</a></li><li class="dropdown-item"><!----> <a href="/backend/cplus/" class="nav-link">
  c++
</a></li><li class="dropdown-item"><!----> <a href="/backend/lua/" class="nav-link">
  lua
</a></li><li class="dropdown-item"><!----> <a href="/backend/vba/" class="nav-link">
  vba
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/database/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/database/mongodb/" class="nav-link">
  mongodb
</a></li><li class="dropdown-item"><!----> <a href="/database/redis/" class="nav-link">
  redis
</a></li><li class="dropdown-item"><!----> <a href="/database/etcd/" class="nav-link">
  etcd
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/programming/algo/" class="nav-link">
  算法与数据结构
</a></li><li class="dropdown-item"><!----> <a href="/programming/pattern/" class="nav-link router-link-active">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="操作系统" class="dropdown-title"><span class="title">操作系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/opersystem/windows/" class="nav-link">
  windows
</a></li><li class="dropdown-item"><!----> <a href="/opersystem/linux/" class="nav-link">
  linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tool/git/" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/tool/goland/" class="nav-link">
  goland
</a></li><li class="dropdown-item"><!----> <a href="/tool/vscode/" class="nav-link">
  vscode
</a></li><li class="dropdown-item"><!----> <a href="/tool/pycharm/" class="nav-link">
  pycharm
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/nginx/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/other/rabbitmq/" class="nav-link">
  rabbitmq
</a></li><li class="dropdown-item"><!----> <a href="/other/docker/" class="nav-link">
  docker
</a></li><li class="dropdown-item"><!----> <a href="/other/k8s/" class="nav-link">
  k8s
</a></li><li class="dropdown-item"><!----> <a href="/other/workrecord/" class="nav-link">
  工作记录
</a></li><li class="dropdown-item"><!----> <a href="/other/interview/" class="nav-link">
  面试宝典
</a></li><li class="dropdown-item"><!----> <a href="/other/other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  vue
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/jlinzhou" target="_self" rel="" class="nav-link external">
  Github
  <!----></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/golang/" class="nav-link">
  golang
</a></li><li class="dropdown-item"><!----> <a href="/backend/python/" class="nav-link">
  python
</a></li><li class="dropdown-item"><!----> <a href="/backend/cplus/" class="nav-link">
  c++
</a></li><li class="dropdown-item"><!----> <a href="/backend/lua/" class="nav-link">
  lua
</a></li><li class="dropdown-item"><!----> <a href="/backend/vba/" class="nav-link">
  vba
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/database/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/database/mongodb/" class="nav-link">
  mongodb
</a></li><li class="dropdown-item"><!----> <a href="/database/redis/" class="nav-link">
  redis
</a></li><li class="dropdown-item"><!----> <a href="/database/etcd/" class="nav-link">
  etcd
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/programming/algo/" class="nav-link">
  算法与数据结构
</a></li><li class="dropdown-item"><!----> <a href="/programming/pattern/" class="nav-link router-link-active">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="操作系统" class="dropdown-title"><span class="title">操作系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/opersystem/windows/" class="nav-link">
  windows
</a></li><li class="dropdown-item"><!----> <a href="/opersystem/linux/" class="nav-link">
  linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tool/git/" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/tool/goland/" class="nav-link">
  goland
</a></li><li class="dropdown-item"><!----> <a href="/tool/vscode/" class="nav-link">
  vscode
</a></li><li class="dropdown-item"><!----> <a href="/tool/pycharm/" class="nav-link">
  pycharm
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/nginx/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/other/rabbitmq/" class="nav-link">
  rabbitmq
</a></li><li class="dropdown-item"><!----> <a href="/other/docker/" class="nav-link">
  docker
</a></li><li class="dropdown-item"><!----> <a href="/other/k8s/" class="nav-link">
  k8s
</a></li><li class="dropdown-item"><!----> <a href="/other/workrecord/" class="nav-link">
  工作记录
</a></li><li class="dropdown-item"><!----> <a href="/other/interview/" class="nav-link">
  面试宝典
</a></li><li class="dropdown-item"><!----> <a href="/other/other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  vue
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/jlinzhou" target="_self" rel="" class="nav-link external">
  Github
  <!----></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>pattern</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/programming/pattern/" class="sidebar-link">设计模式原则</a></li><li><a href="/programming/pattern/item.html" class="active sidebar-link">23种设计模式简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_1-singleton-单例模式" class="sidebar-link">1. SINGLETON 单例模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_2-factory-method-工厂方法模式" class="sidebar-link">2. FACTORY METHOD 工厂方法模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_3-factory-工厂模式" class="sidebar-link">3. FACTORY 工厂模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_4-builder-建造模式" class="sidebar-link">4. BUILDER 建造模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_5-prototype-原型模式" class="sidebar-link">5. PROTOTYPE 原型模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_6-adapter-适配器模式" class="sidebar-link">6. ADAPTER 适配器模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_7-bridge-桥梁模式" class="sidebar-link">7. BRIDGE 桥梁模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_8-composite-合成模式" class="sidebar-link">8. COMPOSITE 合成模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_9-decorator-装饰模式" class="sidebar-link">9. DECORATOR 装饰模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_10-facade-门面（外观）模式" class="sidebar-link">10. FACADE 门面（外观）模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_11-flyweight-享元模式" class="sidebar-link">11. FLYWEIGHT 享元模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_12-proxy-代理模式" class="sidebar-link">12. PROXY 代理模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_13-chain-of-responsibleity-责任链模式" class="sidebar-link">13. CHAIN OF RESPONSIBLEITY 责任链模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_14-command-命令模式" class="sidebar-link">14. COMMAND 命令模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_15-interpreter-解释器模式" class="sidebar-link">15. INTERPRETER 解释器模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_16-iterator-迭代子模式" class="sidebar-link">16. ITERATOR 迭代子模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_17-mediator-调停者模式" class="sidebar-link">17. MEDIATOR 调停者模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_18-memento-备忘录模式" class="sidebar-link">18. MEMENTO 备忘录模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_19-observer-观察者模式" class="sidebar-link">19. OBSERVER 观察者模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_20-state-状态模式" class="sidebar-link">20. STATE 状态模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_21-strategy-策略模式" class="sidebar-link">21. STRATEGY 策略模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_22-template-method-模板模式" class="sidebar-link">22. TEMPLATE METHOD 模板模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#_23-visitor-访问者模式" class="sidebar-link">23. VISITOR 访问者模式</a></li><li class="sidebar-sub-header"><a href="/programming/pattern/item.html#设计模式小结" class="sidebar-link">设计模式小结</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-singleton-单例模式"><a href="#_1-singleton-单例模式" class="header-anchor">#</a> 1. SINGLETON 单例模式</h2> <p>单例模式：单例模式确保某一个类只有一个实例，而且自行实例化并向整个系统提供这个实例单例模式。单例模式只应在有真正的“单一实例”的需求时才可使用。</p> <p>俺有6个漂亮的老婆，她们的老公都是我，我就是我们家里的老公Sigleton，她们只要说道“老公”，都是指的同一个人，那就是我(刚才做了个梦啦，哪有这么好的事)。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;sync&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span>  Single <span class="token keyword">struct</span><span class="token punctuation">{</span>
	data <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> singleton <span class="token operator">*</span> Single
<span class="token keyword">var</span> once sync<span class="token punctuation">.</span>Once <span class="token comment">//内核信号，时时刻刻智能运行一个</span>

<span class="token keyword">func</span> <span class="token function">GetInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>Single<span class="token punctuation">{</span>
	<span class="token comment">//once.Do(func (){singleton=&amp;Single{100}}) 单例</span>
	singleton<span class="token operator">=</span><span class="token operator">&amp;</span>Single<span class="token punctuation">{</span><span class="token number">100</span><span class="token punctuation">}</span>
	<span class="token keyword">return</span> singleton
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	i1<span class="token operator">:=</span><span class="token function">GetInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	i2<span class="token operator">:=</span><span class="token function">GetInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> i1<span class="token operator">==</span>i2<span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;相等&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;不等&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2-factory-method-工厂方法模式"><a href="#_2-factory-method-工厂方法模式" class="header-anchor">#</a> 2. FACTORY METHOD 工厂方法模式</h2> <p>工厂方法模式：核心工厂类不再负责所有产品的创建，而是将具体创建的工作交给子类去做，成为一个抽象工厂角色，仅负责给出具体工厂类必须实现的接口，而不接触哪一个产品类应当被实例化这种细节。</p> <p>请MM去麦当劳吃汉堡，不同的MM有不同的口味，要每个都记住是一件烦人的事情，我一般采用Factory Method模式，带着MM到服务员那儿，说“要一个汉堡”，具体要什么样的汉堡呢，让MM直接跟服务员说就行了。</p> <p><strong>简单工厂</strong></p> <p>一个工厂，通过传递不同参数选择实例化不同的产品</p> <p>缺点： 简单工厂对于增加新的产品，无能为力 ，(要增加新工厂)。不符合  符合开放-封闭原则</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">//中国人，你好</span>
<span class="token comment">//英国人 ,hello</span>
<span class="token comment">//---------------------------------</span>
<span class="token keyword">type</span> API <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token comment">//接口</span>
	<span class="token function">Say</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token keyword">func</span> <span class="token function">NewAPI</span><span class="token punctuation">(</span>str <span class="token builtin">string</span><span class="token punctuation">)</span>API<span class="token punctuation">{</span>
	<span class="token keyword">if</span> str<span class="token operator">==</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token operator">&amp;</span>English<span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> str<span class="token operator">==</span><span class="token string">&quot;cn&quot;</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token operator">&amp;</span>Chinese<span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token keyword">type</span>  Chinese <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>Chinese<span class="token punctuation">)</span>	<span class="token function">Say</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token builtin">string</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token string">&quot;你好&quot;</span><span class="token operator">+</span>name
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token keyword">type</span>  English <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>English<span class="token punctuation">)</span>	<span class="token function">Say</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token builtin">string</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token string">&quot;hello&quot;</span><span class="token operator">+</span>name
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token keyword">type</span>  Japanese <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>Japanese<span class="token punctuation">)</span>	<span class="token function">Say</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token builtin">string</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token string">&quot;鬼子你好&quot;</span><span class="token operator">+</span>name
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main11</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	api<span class="token operator">:=</span><span class="token function">NewAPI</span><span class="token punctuation">(</span><span class="token string">&quot;cn&quot;</span><span class="token punctuation">)</span>
	server<span class="token operator">:=</span>api<span class="token punctuation">.</span><span class="token function">Say</span><span class="token punctuation">(</span><span class="token string">&quot;张海涛&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main12</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	api<span class="token operator">:=</span><span class="token function">NewAPI</span><span class="token punctuation">(</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">)</span>
	server<span class="token operator">:=</span>api<span class="token punctuation">.</span><span class="token function">Say</span><span class="token punctuation">(</span><span class="token string">&quot;Alex&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>工厂方法</strong></p> <p>一个产品，有很多的工厂生产。</p> <p>优点：同时增加某一类”东西“并不需要修改工厂类，只需要添加生产这类”东西“的工厂即可 。符合开放-封闭原则</p> <p>缺点： 在增加新的产品时，也必须增加新的工厂类</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token comment">// A X B</span>
<span class="token comment">//X操作</span>
<span class="token comment">//A B  操作数</span>
<span class="token comment">// x=+  A+B  x=-  A-b  x=%  A%B</span>
<span class="token comment">// left, right,</span>
<span class="token comment">//---------------------------------</span>
<span class="token comment">//实际运行类的接口</span>
<span class="token keyword">type</span>  Operator <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Setleft</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>
	<span class="token function">SetRight</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>
	<span class="token function">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token comment">//工厂接口</span>
<span class="token keyword">type</span> OperatorFactory <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Operator
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token comment">//数据</span>
<span class="token keyword">type</span> OperatorBase <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	left<span class="token punctuation">,</span>right <span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token comment">//赋值</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>op<span class="token operator">*</span>OperatorBase<span class="token punctuation">)</span><span class="token function">Setleft</span><span class="token punctuation">(</span>left <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	op<span class="token punctuation">.</span>left<span class="token operator">=</span>left
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>op<span class="token operator">*</span>OperatorBase<span class="token punctuation">)</span><span class="token function">SetRight</span><span class="token punctuation">(</span>right <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	op<span class="token punctuation">.</span>right<span class="token operator">=</span>right
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token comment">//操作的抽象</span>
<span class="token keyword">type</span> PlusOperatorFactory <span class="token keyword">struct</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//操作类中包含操作数</span>
<span class="token keyword">type</span> PlusOperator <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token operator">*</span>OperatorBase
<span class="token punctuation">}</span>
<span class="token comment">//实际运行</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>o PlusOperator<span class="token punctuation">)</span><span class="token function">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">int</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> o<span class="token punctuation">.</span>right<span class="token operator">+</span>o<span class="token punctuation">.</span>left
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>PlusOperatorFactory<span class="token punctuation">)</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Operator<span class="token punctuation">{</span>
	<span class="token keyword">return</span>  <span class="token operator">&amp;</span>PlusOperator<span class="token punctuation">{</span><span class="token operator">&amp;</span>OperatorBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token comment">//操作的抽象</span>
<span class="token keyword">type</span> SubOperatorFactory <span class="token keyword">struct</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//操作类中包含操作数</span>
<span class="token keyword">type</span> SubOperator <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token operator">*</span>OperatorBase
<span class="token punctuation">}</span>
<span class="token comment">//实际运行</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>o SubOperator<span class="token punctuation">)</span><span class="token function">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">int</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> o<span class="token punctuation">.</span>left<span class="token operator">-</span>o<span class="token punctuation">.</span>right
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>SubOperatorFactory<span class="token punctuation">)</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Operator<span class="token punctuation">{</span>
	<span class="token keyword">return</span>  <span class="token operator">&amp;</span>SubOperator<span class="token punctuation">{</span><span class="token operator">&amp;</span>OperatorBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> fac OperatorFactory<span class="token punctuation">;</span>
	<span class="token comment">//fac=PlusOperatorFactory{}</span>
	fac<span class="token operator">=</span>SubOperatorFactory<span class="token punctuation">{</span><span class="token punctuation">}</span>
	op<span class="token operator">:=</span>fac<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	op<span class="token punctuation">.</span><span class="token function">Setleft</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
	op<span class="token punctuation">.</span><span class="token function">SetRight</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>op<span class="token punctuation">.</span><span class="token function">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>抽象工厂</strong></p> <p>很多产品，有很多的工厂生产。</p> <p>优点：针对产品族；
缺点：针对产品族。
所以，只有对应产品族的情况下，才需要使用抽象工厂模式。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> Abstract_Factory
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">//sqlsever</span>
<span class="token comment">//mysql      sql</span>
<span class="token comment">//oracle</span>

<span class="token comment">//订单</span>
<span class="token comment">//订单报表</span>
<span class="token comment">//---------------------------------</span>
<span class="token keyword">type</span> OrderMainDAO <span class="token keyword">interface</span> <span class="token punctuation">{</span>   <span class="token comment">//订单记录</span>
	<span class="token function">SaveOrderMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//保存，</span>
	<span class="token comment">//DeleleOrderMain()</span>
	<span class="token comment">//SearchOrderMain()</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> OrderDetailDAO <span class="token keyword">interface</span> <span class="token punctuation">{</span> <span class="token comment">//订单详情</span>
	<span class="token function">SaveOrderDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//保存</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> DAOFactory <span class="token keyword">interface</span> <span class="token punctuation">{</span> <span class="token comment">//抽象工厂接口</span>
	<span class="token function">CreateOrderMainDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  OrderMainDAO
	<span class="token function">CreateOrderDetailDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span> OrderDetailDAO
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token comment">//mysql针对两个接口的实现</span>
<span class="token keyword">type</span> MySQLMainDAO <span class="token keyword">struct</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>MySQLMainDAO<span class="token punctuation">)</span> <span class="token function">SaveOrderMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Mysql  main save &quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> MySQLDetailDAO <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>MySQLDetailDAO<span class="token punctuation">)</span><span class="token function">SaveOrderDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;mysql detail save &quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>

<span class="token comment">//抽象工厂</span>
<span class="token keyword">type</span>  MySQLFactory <span class="token keyword">struct</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>MySQLFactory <span class="token punctuation">)</span> <span class="token function">CreateOrderMainDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span> OrderMainDAO<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span> MySQLMainDAO<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>MySQLFactory <span class="token punctuation">)</span> <span class="token function">CreateOrderDetailDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span> OrderDetailDAO<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span> MySQLDetailDAO<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token comment">//抽象工厂</span>
<span class="token keyword">type</span>  OracleFactory <span class="token keyword">struct</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>


<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span> OracleFactory <span class="token punctuation">)</span> <span class="token function">CreateOrderMainDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span> OrderMainDAO<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>  OracleMainDAO<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span> OracleFactory <span class="token punctuation">)</span> <span class="token function">CreateOrderDetailDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span> OrderDetailDAO<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>  OracleDetailDAO<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>

<span class="token comment">//Oracle针对两个接口的实现</span>
<span class="token keyword">type</span> OracleMainDAO <span class="token keyword">struct</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>OracleMainDAO<span class="token punctuation">)</span> <span class="token function">SaveOrderMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Oracle  main save &quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> OracleDetailDAO <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>OracleDetailDAO<span class="token punctuation">)</span><span class="token function">SaveOrderDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Oracle detail save &quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//抽象工厂</span>
	<span class="token keyword">var</span> factory DAOFactory
	<span class="token comment">//factory=&amp;Abstract_Factory.MySQLFactory{}</span>
	factory<span class="token operator">=</span><span class="token operator">&amp;</span>OracleFactory<span class="token punctuation">{</span><span class="token punctuation">}</span>
	factory<span class="token punctuation">.</span><span class="token function">CreateOrderMainDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SaveOrderMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	factory<span class="token punctuation">.</span><span class="token function">CreateOrderDetailDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SaveOrderDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_3-factory-工厂模式"><a href="#_3-factory-工厂模式" class="header-anchor">#</a> 3. FACTORY 工厂模式</h2> <p>工厂模式：客户类和工厂类分开。消费者任何时候需要某种产品，只需向工厂请求即可。消费者无须修改就可以接纳新产品。缺点是当产品修改时，工厂类也要做相应的修改。如：如何创建及如何向客户端提供。</p> <p>追MM少不了请吃饭了，麦当劳的鸡翅和肯德基的鸡翅都是MM爱吃的东西，虽然口味有所不同，但不管你带MM去麦当劳或肯德基，只管向服务员说“来四个鸡翅”就行了。麦当劳和肯德基就是生产鸡翅的Factory。</p> <h2 id="_4-builder-建造模式"><a href="#_4-builder-建造模式" class="header-anchor">#</a> 4. BUILDER 建造模式</h2> <p>建造模式：<strong>将产品的内部表象和产品的生成过程分割开来，从而使一个建造过程生成具有不同的内部表象的产品对象</strong>。建造模式使得产品内部表象可以独立的变化，客户不必知道产品内部组成的细节。建造模式可以强制实行一种分步骤进行的建造过程。</p> <p>MM超级爱听的就是“我爱你”这句话了，见到不同地方的MM，要能够用她们的方言跟她说这句话哦，我有一个多种语言翻译机，上面每种语言都有一个按键，见到MM我只要按对应的键，它就能够用相应的语言说出“我爱你”这句话了，国外的MM也可以轻松搞掂，这就是我的“我爱你”builder。（这一定比美军在伊拉克用的翻译机好卖）</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> Builder

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token comment">//-------------------------------</span>
<span class="token keyword">type</span>  Builder <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Part1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">Part2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">Part3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//&quot;1&quot;+&quot;2&quot;+&quot;3&quot;=&quot;123&quot;</span>
<span class="token comment">//1+2+3=6</span>

<span class="token keyword">type</span> Director <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	builder  Builder <span class="token comment">//建造者的接口</span>
<span class="token punctuation">}</span>
<span class="token comment">//创造接口</span>
<span class="token keyword">func</span> <span class="token function">NewDirector</span><span class="token punctuation">(</span>	builder  Builder <span class="token punctuation">)</span><span class="token operator">*</span>Director<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>Director<span class="token punctuation">{</span>builder<span class="token punctuation">:</span>builder<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>d<span class="token operator">*</span> Director<span class="token punctuation">)</span><span class="token function">Makedata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	d<span class="token punctuation">.</span>builder<span class="token punctuation">.</span><span class="token function">Part1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	d<span class="token punctuation">.</span>builder<span class="token punctuation">.</span><span class="token function">Part2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	d<span class="token punctuation">.</span>builder<span class="token punctuation">.</span><span class="token function">Part3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//-------------------------------</span>
<span class="token keyword">type</span> IntBuilder <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	result <span class="token builtin">int64</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>sb <span class="token operator">*</span>IntBuilder<span class="token punctuation">)</span><span class="token function">Part1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	sb<span class="token punctuation">.</span>result<span class="token operator">+=</span><span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sb <span class="token operator">*</span>IntBuilder<span class="token punctuation">)</span><span class="token function">Part2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	sb<span class="token punctuation">.</span>result<span class="token operator">+=</span><span class="token number">2</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sb <span class="token operator">*</span>IntBuilder<span class="token punctuation">)</span><span class="token function">Part3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	sb<span class="token punctuation">.</span>result<span class="token operator">+=</span><span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sb <span class="token operator">*</span>IntBuilder<span class="token punctuation">)</span><span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int64</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> sb<span class="token punctuation">.</span>result
<span class="token punctuation">}</span>
<span class="token comment">//-------------------------------</span>

<span class="token keyword">type</span> StringBuilder <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	result <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>sb <span class="token operator">*</span>StringBuilder<span class="token punctuation">)</span><span class="token function">Part1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	sb<span class="token punctuation">.</span>result<span class="token operator">+=</span><span class="token string">&quot;1&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sb <span class="token operator">*</span>StringBuilder<span class="token punctuation">)</span><span class="token function">Part2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	sb<span class="token punctuation">.</span>result<span class="token operator">+=</span><span class="token string">&quot;2&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sb <span class="token operator">*</span>StringBuilder<span class="token punctuation">)</span><span class="token function">Part3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	sb<span class="token punctuation">.</span>result<span class="token operator">+=</span><span class="token string">&quot;3&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sb <span class="token operator">*</span>StringBuilder<span class="token punctuation">)</span><span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">string</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> sb<span class="token punctuation">.</span>result
<span class="token punctuation">}</span>
<span class="token comment">//-------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//builder:=&amp;Builder.StringBuilder{}</span>
	builder<span class="token operator">:=</span><span class="token operator">&amp;</span>IntBuilder<span class="token punctuation">{</span><span class="token punctuation">}</span>
	dict<span class="token operator">:=</span><span class="token function">NewDirector</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span>
	dict<span class="token punctuation">.</span><span class="token function">Makedata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_5-prototype-原型模式"><a href="#_5-prototype-原型模式" class="header-anchor">#</a> 5. PROTOTYPE 原型模式</h2> <p>原型模式允许动态的增加或减少产品类，产品类不需要非得有任何事先确定的等级结构，原始模型模式适用于任何的等级结构。缺点是每一个类都必须配备一个克隆方法。</p> <p>跟MM用QQ聊天，一定要说些深情的话语了，我搜集了好多肉麻的情话，需要时只要copy出来放到QQ里面就行了，这就是我的情话prototype了。 原型模式：通过给出一个原型对象来指明所要创建的对象的类型，然后用复制这个原型对象的方法创建出更多同类型的对象。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">//原型对象需要实现的接口</span>
<span class="token comment">//map  map[&quot;&quot;1232]=1232</span>
<span class="token comment">//拷贝原有的对象</span>
<span class="token keyword">type</span> Cloneable <span class="token keyword">interface</span><span class="token punctuation">{</span>
	<span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Cloneable
<span class="token punctuation">}</span>

<span class="token comment">//原型对象的类</span>
<span class="token keyword">type</span> PrototypeManger <span class="token keyword">struct</span><span class="token punctuation">{</span>
	prototypes <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>Cloneable
<span class="token punctuation">}</span>
<span class="token comment">//构造初始化</span>
<span class="token keyword">func</span> <span class="token function">NewPrototypeManger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> PrototypeManger<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>PrototypeManger<span class="token punctuation">{</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>Cloneable<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//抓取</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p<span class="token operator">*</span> PrototypeManger<span class="token punctuation">)</span><span class="token function">Get</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span>Cloneable<span class="token punctuation">{</span>
	<span class="token keyword">return</span> p<span class="token punctuation">.</span>prototypes<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">//设置</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p<span class="token operator">*</span> PrototypeManger<span class="token punctuation">)</span><span class="token function">Set</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span> prototype Cloneable<span class="token punctuation">)</span><span class="token punctuation">{</span>
	p<span class="token punctuation">.</span>prototypes<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token operator">=</span>prototype
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Type1 <span class="token keyword">struct</span><span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>t<span class="token operator">*</span>Type1<span class="token punctuation">)</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Cloneable<span class="token punctuation">{</span>
	<span class="token comment">//tc:=*t</span>
	<span class="token comment">//return &amp;tc 深复制</span>
	<span class="token keyword">return</span> t
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Type2 <span class="token keyword">struct</span><span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>t<span class="token operator">*</span>Type2<span class="token punctuation">)</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Cloneable<span class="token punctuation">{</span>
	tc<span class="token operator">:=</span><span class="token operator">*</span>t <span class="token comment">//开辟内存新建变量，存储指针指向的内容</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>tc <span class="token comment">//返回地址</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	mgr<span class="token operator">:=</span><span class="token function">NewPrototypeManger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	t1<span class="token operator">:=</span><span class="token operator">&amp;</span>Type1<span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">&quot;type1&quot;</span><span class="token punctuation">}</span>
	mgr<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">&quot;t1&quot;</span><span class="token punctuation">,</span>t1<span class="token punctuation">)</span>
	t11<span class="token operator">:=</span>mgr<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span>
	t22<span class="token operator">:=</span>t11<span class="token punctuation">.</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//复制</span>
	<span class="token keyword">if</span> t11<span class="token operator">==</span>t22<span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;浅复制&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;深复制&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_6-adapter-适配器模式"><a href="#_6-adapter-适配器模式" class="header-anchor">#</a> 6. ADAPTER 适配器模式</h2> <p>适配器（变压器）模式：把一个类的接口变换成客户端所期待的另一种接口，从而使原本因接口原因不匹配而无法一起工作的两个类能够一起工作。适配类可以根据参数返还一个合适的实例给客户端。</p> <p>在朋友聚会上碰到了一个美女Sarah，从拉斯维加斯来的，可我不会说粤语，她不会说普通话，只好求助于我的朋友kent了，他作为我和Sarah之间的Adapter，让我和Sarah可以相互交谈了(也不知道他会不会耍我)。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token comment">//适配的目标接口</span>
<span class="token keyword">type</span> Target <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Request</span><span class="token punctuation">(</span><span class="token builtin">int</span> <span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> adapter <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Adaptee
<span class="token punctuation">}</span>
<span class="token keyword">func</span>  <span class="token function">NewAdapter</span><span class="token punctuation">(</span>adaptee  Adaptee <span class="token punctuation">)</span>Target <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>adapter<span class="token punctuation">{</span>adaptee<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//接口包装</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>adap <span class="token operator">*</span>adapter<span class="token punctuation">)</span> <span class="token function">Request</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token builtin">string</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> adap<span class="token punctuation">.</span><span class="token function">SpecficRequest</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//被适配</span>
<span class="token keyword">type</span> Adaptee <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">SpecficRequest</span><span class="token punctuation">(</span><span class="token builtin">int</span> <span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token comment">//载体，被适配的目标类</span>
<span class="token keyword">type</span> adapeeImpl <span class="token keyword">struct</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">//工厂函数</span>
<span class="token keyword">func</span> NewAdaptee <span class="token punctuation">(</span><span class="token punctuation">)</span>Adaptee <span class="token punctuation">{</span>
	<span class="token keyword">return</span>  <span class="token operator">&amp;</span>adapeeImpl<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//实际函数</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>ada<span class="token operator">*</span>  adapeeImpl<span class="token punctuation">)</span><span class="token function">SpecficRequest</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">string</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
	<span class="token keyword">return</span><span class="token string">&quot;SpecficRequest你妹&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span>  <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	adapee<span class="token operator">:=</span><span class="token function">NewAdaptee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//适配器</span>
	target<span class="token operator">:=</span><span class="token function">NewAdapter</span><span class="token punctuation">(</span>adapee<span class="token punctuation">)</span><span class="token comment">//传递进入</span>
	res<span class="token operator">:=</span>target<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_7-bridge-桥梁模式"><a href="#_7-bridge-桥梁模式" class="header-anchor">#</a> 7. BRIDGE 桥梁模式</h2> <p>桥梁模式：将抽象化与实现化脱耦，使得二者可以独立的变化，也就是说将他们之间的强关联变成弱关联，也就是指在一个软件系统的抽象化和实现化之间使用组合/聚合关系而不是继承关系，从而使两者可以独立的变化。</p> <p>早上碰到MM，要说早上好，晚上碰到MM，要说晚上好；碰到MM穿了件新衣服，要说你的衣服好漂亮哦，碰到MM新做的发型，要说你的头发好漂亮哦。不要问我“早上碰到MM新做了个发型怎么说”这种问题，自己用BRIDGE组合一下不就行了。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token comment">//-----------------------------------</span>
<span class="token keyword">type</span> ComonMessage <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	method MessageImlementer
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewComonMessage</span><span class="token punctuation">(</span>method MessageImlementer<span class="token punctuation">)</span><span class="token operator">*</span>ComonMessage <span class="token punctuation">{</span>
	<span class="token keyword">return</span>  <span class="token operator">&amp;</span>ComonMessage<span class="token punctuation">{</span>method<span class="token punctuation">:</span>method<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>com <span class="token operator">*</span>  ComonMessage <span class="token punctuation">)</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>to <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	com<span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>to<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------</span>
<span class="token comment">// SMS短信</span>
<span class="token comment">// Email</span>

<span class="token keyword">type</span> AbstractMessage <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">SendMessage</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>to <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token comment">//发送快，发送普通速速</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> MessageImlementer <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Send</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>to <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token comment">//短信，邮件</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------</span>
<span class="token keyword">type</span> MessageEmail <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">ViaEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> MessageImlementer<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>MessageEmail<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>msms<span class="token operator">*</span> MessageEmail<span class="token punctuation">)</span><span class="token function">Send</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>to <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//邮件发送</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;send %s to %s via Email&quot;</span><span class="token punctuation">,</span>text<span class="token punctuation">,</span>to<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------</span>
<span class="token keyword">type</span> MessageSMS <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">ViaSMS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> MessageImlementer<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>MessageSMS<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>msms<span class="token operator">*</span> MessageSMS<span class="token punctuation">)</span><span class="token function">Send</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>to <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//短信发送</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;send %s to %s via SMS&quot;</span><span class="token punctuation">,</span>text<span class="token punctuation">,</span>to<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------</span>
<span class="token keyword">type</span> UrgencyMessage <span class="token keyword">struct</span><span class="token punctuation">{</span>
	method MessageImlementer
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewUrencyMessage</span><span class="token punctuation">(</span>method MessageImlementer<span class="token punctuation">)</span> <span class="token operator">*</span> UrgencyMessage<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>UrgencyMessage<span class="token punctuation">{</span>method<span class="token punctuation">:</span>method<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m<span class="token operator">*</span>UrgencyMessage<span class="token punctuation">)</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span>to <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	m<span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;发送到[%s]&quot;</span><span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span>to<span class="token punctuation">)</span> <span class="token comment">//h很快速度发送</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//m:=NewComonMessage(ViaSMS())</span>
	<span class="token comment">//m:=NewComonMessage(ViaEmail())</span>
	<span class="token comment">//m.SendMessage(&quot;baBy 你好&quot;,&quot;nimei&quot;)</span>
	m<span class="token operator">:=</span><span class="token function">NewUrencyMessage</span><span class="token punctuation">(</span><span class="token function">ViaEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	m<span class="token punctuation">.</span><span class="token function">SendMessage</span><span class="token punctuation">(</span><span class="token string">&quot;baBy 你好&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;nimei&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_8-composite-合成模式"><a href="#_8-composite-合成模式" class="header-anchor">#</a> 8. COMPOSITE 合成模式</h2> <p>合成模式：合成模式将对象组织到树结构中，可以用来描述整体与部分的关系。合成模式就是一个处理对象的树结构的模式。合成模式把部分与整体的关系用树结构表示出来。合成模式使得客户端把一个个单独的成分对象和由他们复合而成的合成对象同等看待。</p> <p>Mary今天过生日。“我过生日，你要送我一件礼物。”“嗯，好吧，去商店，你自己挑。”“这件T恤挺漂亮，买，这条裙子好看，买，这个包也不错，买。”“喂，买了三件了呀，我只答应送一件礼物的哦。”“什么呀，T恤加裙子加包包，正好配成一套呀，小姐，麻烦你包起来。”“……”，MM都会用Composite模式了，你会了没有？</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token comment">//有的时候是父节点，叶子</span>
<span class="token keyword">type</span> Component <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Component
	<span class="token function">SetParent</span><span class="token punctuation">(</span> Component<span class="token punctuation">)</span>
	<span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">string</span>
	<span class="token function">SetName</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span>
	<span class="token function">AddChild</span><span class="token punctuation">(</span> Component<span class="token punctuation">)</span>
	<span class="token function">Print</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">(</span>
	LeafNode<span class="token operator">=</span><span class="token boolean">iota</span>
	CompositeNode
<span class="token punctuation">)</span>

<span class="token keyword">type</span> component <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	parent Component
	name <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span>  <span class="token function">NewComonent</span><span class="token punctuation">(</span>kind <span class="token builtin">int</span> <span class="token punctuation">,</span>name <span class="token builtin">string</span><span class="token punctuation">)</span>Component<span class="token punctuation">{</span>
	<span class="token keyword">var</span> c Component
	<span class="token keyword">switch</span> kind <span class="token punctuation">{</span>
	<span class="token keyword">case</span> LeafNode<span class="token punctuation">:</span>  <span class="token comment">//根据不同的类型</span>
		c<span class="token operator">=</span><span class="token function">NewLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> CompositeNode<span class="token punctuation">:</span>
		c<span class="token operator">=</span><span class="token function">NewComposite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	c<span class="token punctuation">.</span><span class="token function">SetName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
	<span class="token keyword">return</span> c
<span class="token punctuation">}</span>




<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span> component<span class="token punctuation">)</span><span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Component<span class="token punctuation">{</span>
	<span class="token keyword">return</span> c<span class="token punctuation">.</span>parent
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span> component<span class="token punctuation">)</span><span class="token function">SetParent</span><span class="token punctuation">(</span>parent Component<span class="token punctuation">)</span><span class="token punctuation">{</span>
	c<span class="token punctuation">.</span>parent<span class="token operator">=</span>parent
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span> component<span class="token punctuation">)</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">string</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> c<span class="token punctuation">.</span>name
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span> component<span class="token punctuation">)</span><span class="token function">SetName</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	c<span class="token punctuation">.</span>name<span class="token operator">=</span>name
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span> component<span class="token punctuation">)</span><span class="token function">AddChild</span><span class="token punctuation">(</span> Component<span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span> component<span class="token punctuation">)</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">type</span>  Leaf <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	component
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>Leaf<span class="token punctuation">{</span> <span class="token comment">//开辟一个叶子</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>Leaf<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span>Leaf<span class="token punctuation">)</span><span class="token function">Print</span><span class="token punctuation">(</span>pre <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>pre<span class="token punctuation">,</span>c<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Composite <span class="token keyword">struct</span><span class="token punctuation">{</span>
	component
	childs <span class="token punctuation">[</span><span class="token punctuation">]</span> Component <span class="token comment">//叶子集合</span>
<span class="token punctuation">}</span>
<span class="token comment">//创建一个组合结构体</span>
<span class="token keyword">func</span> <span class="token function">NewComposite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>Composite<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>Composite<span class="token punctuation">{</span>childs<span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>Component<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span> Composite<span class="token punctuation">)</span><span class="token function">AddChild</span><span class="token punctuation">(</span>child Component<span class="token punctuation">)</span><span class="token punctuation">{</span>
	child<span class="token punctuation">.</span><span class="token function">SetParent</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
	c<span class="token punctuation">.</span>childs<span class="token operator">=</span><span class="token function">append</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>childs<span class="token punctuation">,</span>child<span class="token punctuation">)</span><span class="token comment">//加入孩子节点</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span> Composite<span class="token punctuation">)</span><span class="token function">Print</span><span class="token punctuation">(</span>pre <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//打印显示每一个节点</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>pre<span class="token punctuation">,</span>c<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	pre<span class="token operator">+=</span><span class="token string">&quot;  &quot;</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span>comp<span class="token operator">:=</span><span class="token keyword">range</span> c<span class="token punctuation">.</span>childs<span class="token punctuation">{</span>
		comp<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span>pre<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//root;</span>
	root<span class="token operator">:=</span><span class="token function">NewComonent</span><span class="token punctuation">(</span>CompositeNode<span class="token punctuation">,</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span>
	r1<span class="token operator">:=</span><span class="token function">NewComonent</span><span class="token punctuation">(</span>CompositeNode<span class="token punctuation">,</span><span class="token string">&quot;r1&quot;</span><span class="token punctuation">)</span>
	r2<span class="token operator">:=</span><span class="token function">NewComonent</span><span class="token punctuation">(</span>CompositeNode<span class="token punctuation">,</span><span class="token string">&quot;r2&quot;</span><span class="token punctuation">)</span>
	r3<span class="token operator">:=</span><span class="token function">NewComonent</span><span class="token punctuation">(</span>CompositeNode<span class="token punctuation">,</span><span class="token string">&quot;r3&quot;</span><span class="token punctuation">)</span>

	l1<span class="token operator">:=</span><span class="token function">NewComonent</span><span class="token punctuation">(</span>LeafNode<span class="token punctuation">,</span><span class="token string">&quot;l1&quot;</span><span class="token punctuation">)</span>
	l2<span class="token operator">:=</span><span class="token function">NewComonent</span><span class="token punctuation">(</span>LeafNode<span class="token punctuation">,</span><span class="token string">&quot;l2&quot;</span><span class="token punctuation">)</span>
	l3<span class="token operator">:=</span><span class="token function">NewComonent</span><span class="token punctuation">(</span>LeafNode<span class="token punctuation">,</span><span class="token string">&quot;l3&quot;</span><span class="token punctuation">)</span>

	root<span class="token punctuation">.</span><span class="token function">AddChild</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span>
	root<span class="token punctuation">.</span><span class="token function">AddChild</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span>
	r1<span class="token punctuation">.</span><span class="token function">AddChild</span><span class="token punctuation">(</span>r3<span class="token punctuation">)</span>

	r1<span class="token punctuation">.</span><span class="token function">AddChild</span><span class="token punctuation">(</span>l1<span class="token punctuation">)</span>

	r2<span class="token punctuation">.</span><span class="token function">AddChild</span><span class="token punctuation">(</span>l2<span class="token punctuation">)</span>
	r2<span class="token punctuation">.</span><span class="token function">AddChild</span><span class="token punctuation">(</span>l3<span class="token punctuation">)</span>
	root<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>


<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9-decorator-装饰模式"><a href="#_9-decorator-装饰模式" class="header-anchor">#</a> 9. DECORATOR 装饰模式</h2> <p>装饰模式：装饰模式以对客户端透明的方式扩展对象的功能，是继承关系的一个替代方案，提供比继承更多的灵活性。动态给一个对象增加功能，这些功能可以再动态的撤消。增加由一些基本功能的排列组合而产生的非常大量的功能。</p> <p>Mary过完轮到Sarly过生日，还是不要叫她自己挑了，不然这个月伙食费肯定玩完，拿出我去年在华山顶上照的照片，在背面写上“**的的礼物，就是爱你的Fita”，再到街上礼品店买了个像框（卖礼品的MM也很漂亮哦），再找隔壁搞美术设计的Mike设计了一个漂亮的盒子装起来……，我们都是Decorator，最终都在修饰我这个人呀，怎么样，看懂了吗？</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> Deacorator

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">type</span>  AddComponent <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Component
	num <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">WarpAddComponent</span><span class="token punctuation">(</span>c  Component<span class="token punctuation">,</span>num <span class="token builtin">int</span> <span class="token punctuation">)</span>Component<span class="token punctuation">{</span>
	<span class="token keyword">return</span>  <span class="token operator">&amp;</span>AddComponent<span class="token punctuation">{</span>c<span class="token punctuation">,</span>num<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//+</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mul <span class="token operator">*</span>AddComponent<span class="token punctuation">)</span><span class="token function">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> mul<span class="token punctuation">.</span>Component<span class="token punctuation">.</span><span class="token function">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>mul<span class="token punctuation">.</span>num
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------</span>
<span class="token keyword">type</span>  Component <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> ConcreateComponent <span class="token keyword">struct</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>ConcreateComponent <span class="token punctuation">)</span><span class="token function">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------</span>
<span class="token keyword">type</span>  MulComponent <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Component
	num <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">WarpMulComponent</span><span class="token punctuation">(</span>c  Component<span class="token punctuation">,</span>num <span class="token builtin">int</span> <span class="token punctuation">)</span>Component<span class="token punctuation">{</span>
	<span class="token keyword">return</span>  <span class="token operator">&amp;</span>MulComponent<span class="token punctuation">{</span>c<span class="token punctuation">,</span>num<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//乘法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mul <span class="token operator">*</span>MulComponent<span class="token punctuation">)</span><span class="token function">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> mul<span class="token punctuation">.</span>Component<span class="token punctuation">.</span><span class="token function">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>mul<span class="token punctuation">.</span>num
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------</span>

<span class="token keyword">func</span> <span class="token function">main6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> c Component<span class="token operator">=</span><span class="token operator">&amp;</span>ConcreateComponent<span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token comment">//c=Deacorator.WarpAddComponent(c,10)</span>
	c<span class="token operator">=</span><span class="token function">WarpMulComponent</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">Calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_10-facade-门面（外观）模式"><a href="#_10-facade-门面（外观）模式" class="header-anchor">#</a> 10. FACADE 门面（外观）模式</h2> <p>门面模式：外部与一个子系统的通信必须通过一个统一的门面对象进行。门面模式提供一个高层次的接口，使得子系统更易于使用。每一个子系统只有一个门面类，而且此门面类只有一个实例，也就是说它是一个单例模式。但整个系统可以有多个门面类。</p> <p>我有一个专业的Nikon相机，我就喜欢自己手动调光圈、快门，这样照出来的照片才专业，但MM可不懂这些，教了半天也不会。幸好相机有Facade设计模式，把相机调整到自动档，只要对准目标按快门就行了，一切由相机自动调整，这样MM也可以用这个相机给我拍张照片了。</p> <div class="language-go extra-class"><pre class="language-go"><code>
</code></pre></div><h2 id="_11-flyweight-享元模式"><a href="#_11-flyweight-享元模式" class="header-anchor">#</a> 11. FLYWEIGHT 享元模式</h2> <p>享元模式：FLYWEIGHT在拳击比赛中指最轻量级。享元模式以共享的方式高效的支持大量的细粒度对象。享元模式能做到共享的关键是区分内蕴状态和外蕴状态。内蕴状态存储在享元内部，不会随环境的改变而有所不同。外蕴状态是随环境的改变而改变的。外蕴状态不能影响内蕴状态，它们是相互独立的。将可以共享的状态和不可以共享的状态从常规类中区分开来，将不可以共享的状态从类里剔除出去。客户端不可以直接创建被共享的对象，而应当使用一个工厂对象负责创建被共享的对象。享元模式大幅度的降低内存中对象的数量。</p> <p>每天跟MM发短信，手指都累死了，最近买了个新手机，可以把一些常用的句子存在手机里，要用的时候，直接拿出来，在前面加上MM的名字就可以发送了，再不用一个字一个字敲了。共享的句子就是Flyweight，MM的名字就是提取出来的外部特征，根据上下文情况使用。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> ImageFlyWeight <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	data <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token comment">//初始化</span>
<span class="token keyword">func</span> <span class="token function">NewImageFlyweight</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">*</span>ImageFlyWeight<span class="token punctuation">{</span>
	data<span class="token operator">:=</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;image data %s&quot;</span><span class="token punctuation">,</span>filename<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>ImageFlyWeight<span class="token punctuation">{</span>data<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span>  <span class="token punctuation">(</span>i<span class="token operator">*</span>ImageFlyWeight  <span class="token punctuation">)</span><span class="token function">Data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span><span class="token punctuation">{</span> <span class="token comment">//截取数据</span>
	<span class="token keyword">return</span> i<span class="token punctuation">.</span>data
<span class="token punctuation">}</span>
<span class="token comment">//----------------------------------------------</span>

<span class="token keyword">var</span> imgflyfactory<span class="token operator">*</span> ImageFlyWeightFactory

<span class="token keyword">type</span> ImageFlyWeightFactory <span class="token keyword">struct</span><span class="token punctuation">{</span>
	 maps <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>ImageFlyWeight
<span class="token punctuation">}</span>

<span class="token comment">//对象初始化，不会反复初始化，</span>
<span class="token keyword">func</span> <span class="token function">GetImageFlyWeightFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span> ImageFlyWeightFactory <span class="token punctuation">{</span>
	<span class="token keyword">if</span> imgflyfactory<span class="token operator">==</span><span class="token boolean">nil</span><span class="token punctuation">{</span>
		imgflyfactory<span class="token operator">=</span><span class="token operator">&amp;</span> ImageFlyWeightFactory<span class="token punctuation">{</span><span class="token function">make</span><span class="token punctuation">(</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>ImageFlyWeight<span class="token punctuation">)</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> imgflyfactory
<span class="token punctuation">}</span>

<span class="token keyword">func</span>  <span class="token punctuation">(</span>imf <span class="token operator">*</span>ImageFlyWeightFactory<span class="token punctuation">)</span><span class="token function">Get</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">*</span>ImageFlyWeight<span class="token punctuation">{</span>
	image<span class="token operator">:=</span>imf<span class="token punctuation">.</span>maps<span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token comment">//取出，map去掉重复</span>
	<span class="token keyword">if</span> image <span class="token operator">==</span><span class="token boolean">nil</span><span class="token punctuation">{</span>
		image<span class="token operator">=</span><span class="token function">NewImageFlyweight</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token comment">//存储进入</span>
		imf<span class="token punctuation">.</span>maps<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token operator">=</span>image
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> image
<span class="token punctuation">}</span>
<span class="token comment">//----------------------------------------------</span>
<span class="token keyword">type</span> ImageViewer <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token operator">*</span>ImageFlyWeight
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewImageViewer</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">*</span>ImageViewer<span class="token punctuation">{</span>
	image<span class="token operator">:=</span><span class="token function">GetImageFlyWeightFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>ImageViewer<span class="token punctuation">{</span>image<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>i<span class="token operator">*</span>ImageViewer<span class="token punctuation">)</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Display %s\n&quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//----------------------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	v1<span class="token operator">:=</span><span class="token function">NewImageViewer</span><span class="token punctuation">(</span><span class="token string">&quot;1.jpg&quot;</span><span class="token punctuation">)</span>
	v1<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	v2<span class="token operator">:=</span><span class="token function">NewImageViewer</span><span class="token punctuation">(</span><span class="token string">&quot;1.jpg&quot;</span><span class="token punctuation">)</span>
	v2<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> v1<span class="token punctuation">.</span>ImageFlyWeight<span class="token operator">==</span>v2<span class="token punctuation">.</span>ImageFlyWeight<span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;节约内存&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;langfei内存&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_12-proxy-代理模式"><a href="#_12-proxy-代理模式" class="header-anchor">#</a> 12. PROXY 代理模式</h2> <p>代理模式：代理模式给某一个对象提供一个代理对象，并由代理对象控制对源对象的引用。代理就是一个人或一个机构代表另一个人或者一个机构采取行动。某些情况下，客户不想或者不能够直接引用一个对象，代理对象可以在客户和目标对象直接起到中介的作用。客户端分辨不出代理主题对象与真实主题对象。代理模式可以并不知道真正的被代理对象，而仅仅持有一个被代理对象的接口，这时候代理对象不能够创建被代理对象，被代理对象必须有系统的其他角色代为创建并传入。</p> <p>跟MM在网上聊天，一开头总是“hi,你好”,“你从哪儿来呀？”“你多大了？”“身高多少呀？”这些话，真烦人，写个程序做为我的Proxy吧，凡是接收到这些话都设置好了自己的回答，接收到其他的话时再通知我回答，怎么样，酷吧。</p> <div class="language-go extra-class"><pre class="language-go"><code>
</code></pre></div><h2 id="_13-chain-of-responsibleity-责任链模式"><a href="#_13-chain-of-responsibleity-责任链模式" class="header-anchor">#</a> 13. CHAIN OF RESPONSIBLEITY 责任链模式</h2> <p>责任链模式：在责任链模式中，很多对象由每一个对象对其下家的引用而接起来形成一条链。请求在这个链上传递，直到链上的某一个对象决定处理此请求。客户并不知道链上的哪一个对象最终处理这个请求，系统可以在不影响客户端的情况下动态的重新组织链和分配责任。处理者有两个选择：承担责任或者把责任推给下家。一个请求可以最终不被任何接收端对象所接受。</p> <p>晚上去上英语课，为了好开溜坐到了然后一排，哇，前面坐了好几个漂亮的MM哎，找张纸条，写上“Hi,可以做我的女朋友吗？如果不愿意请向前传”，纸条就一个接一个的传上去了，糟糕，传到**排的MM把纸条传给老师了，听说是个老一手女呀，快跑!</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> test
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">type</span> DepManager <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewDepManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>DepManager<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>DepManager<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewDepManagerChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>RequestChain<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>RequestChain<span class="token punctuation">{</span><span class="token operator">&amp;</span>DepManager<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">nil</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">func</span> <span class="token punctuation">(</span>dm <span class="token operator">*</span>DepManager<span class="token punctuation">)</span> <span class="token function">HaveRight</span><span class="token punctuation">(</span>money <span class="token builtin">int</span> <span class="token punctuation">)</span><span class="token builtin">bool</span>  <span class="token punctuation">{</span>
	<span class="token keyword">return</span>  money <span class="token operator">&lt;</span><span class="token number">5000</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>dm <span class="token operator">*</span>DepManager<span class="token punctuation">)</span> <span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span>money <span class="token builtin">int</span> <span class="token punctuation">)</span><span class="token builtin">bool</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span> name<span class="token operator">==</span><span class="token string">&quot;lixiang&quot;</span><span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;DepManager  授权%s %d\n&quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>money<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;DepManager not 授权%s %d\n&quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>money<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------------</span>
<span class="token keyword">type</span> GenaralManager <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewGenaralManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>GenaralManager<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>GenaralManager<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewGenaralManagerChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>RequestChain<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>RequestChain<span class="token punctuation">{</span><span class="token operator">&amp;</span>GenaralManager<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">nil</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>pm <span class="token operator">*</span>GenaralManager<span class="token punctuation">)</span> <span class="token function">HaveRight</span><span class="token punctuation">(</span>money <span class="token builtin">int</span> <span class="token punctuation">)</span><span class="token builtin">bool</span>  <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>pm <span class="token operator">*</span>GenaralManager<span class="token punctuation">)</span> <span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span>money <span class="token builtin">int</span> <span class="token punctuation">)</span><span class="token builtin">bool</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span> name<span class="token operator">==</span><span class="token string">&quot;weishangyin&quot;</span><span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;GenaralManager  授权%s %d\n&quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>money<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;GenaralManager not 授权%s %d\n&quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>money<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------------</span>
<span class="token comment">//主管  经理  总经理  董事长</span>
<span class="token comment">//50 100   150   200</span>
<span class="token keyword">type</span> Manger <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">HaveRight</span><span class="token punctuation">(</span>money <span class="token builtin">int</span> <span class="token punctuation">)</span><span class="token builtin">bool</span>  <span class="token comment">//判断权限</span>
	<span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span>money <span class="token builtin">int</span> <span class="token punctuation">)</span><span class="token builtin">bool</span><span class="token comment">//向后传递</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------------</span>

<span class="token keyword">type</span> ProjectManager <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewProjectManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>ProjectManager<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>ProjectManager<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewProjectManagerChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>RequestChain<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>RequestChain<span class="token punctuation">{</span><span class="token operator">&amp;</span>ProjectManager<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">nil</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>pm <span class="token operator">*</span>ProjectManager<span class="token punctuation">)</span> <span class="token function">HaveRight</span><span class="token punctuation">(</span>money <span class="token builtin">int</span> <span class="token punctuation">)</span><span class="token builtin">bool</span>  <span class="token punctuation">{</span>
	<span class="token keyword">return</span>  money <span class="token operator">&lt;</span><span class="token number">1000</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>pm <span class="token operator">*</span>ProjectManager<span class="token punctuation">)</span> <span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span>money <span class="token builtin">int</span> <span class="token punctuation">)</span><span class="token builtin">bool</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span> name<span class="token operator">==</span><span class="token string">&quot;hupeng&quot;</span><span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;ProjectManager 授权%s %d\n&quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>money<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;ProjectManager not 授权%s %d\n&quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">,</span>money<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------------</span>

<span class="token keyword">type</span> RequestChain <span class="token keyword">struct</span><span class="token punctuation">{</span>
	Manger
	successor <span class="token operator">*</span>RequestChain <span class="token comment">//处理成功</span>
<span class="token punctuation">}</span>

<span class="token comment">//判断责任链在哪里结束</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>rc<span class="token operator">*</span> RequestChain<span class="token punctuation">)</span><span class="token function">SetSuceessor</span><span class="token punctuation">(</span>endrc <span class="token operator">*</span>RequestChain<span class="token punctuation">)</span><span class="token punctuation">{</span>
	rc<span class="token punctuation">.</span>successor<span class="token operator">=</span>endrc
<span class="token punctuation">}</span>
<span class="token comment">//权力判断</span>
<span class="token keyword">func</span>  <span class="token punctuation">(</span>rc<span class="token operator">*</span> RequestChain<span class="token punctuation">)</span><span class="token function">HaveRight</span><span class="token punctuation">(</span>money <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token builtin">bool</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
<span class="token comment">//向后传递,有权利当场处理，没有权利放弃，向后传递</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>rc<span class="token operator">*</span> RequestChain<span class="token punctuation">)</span><span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span>money <span class="token builtin">int</span> <span class="token punctuation">)</span><span class="token builtin">bool</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span> rc<span class="token punctuation">.</span>Manger<span class="token punctuation">.</span><span class="token function">HaveRight</span><span class="token punctuation">(</span>money<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> rc<span class="token punctuation">.</span>Manger<span class="token punctuation">.</span><span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>money<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> rc<span class="token punctuation">.</span>successor<span class="token operator">!=</span><span class="token boolean">nil</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> rc<span class="token punctuation">.</span>successor<span class="token punctuation">.</span><span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>money<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	c1<span class="token operator">:=</span><span class="token function">NewProjectManagerChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	c2<span class="token operator">:=</span><span class="token function">NewDepManagerChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	c3<span class="token operator">:=</span><span class="token function">NewGenaralManagerChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	c1<span class="token punctuation">.</span><span class="token function">SetSuceessor</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span>
	c2<span class="token punctuation">.</span><span class="token function">SetSuceessor</span><span class="token punctuation">(</span>c3<span class="token punctuation">)</span>

	<span class="token keyword">var</span> c Manger <span class="token operator">=</span>c1
	c<span class="token punctuation">.</span><span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span><span class="token string">&quot;hupeng&quot;</span><span class="token punctuation">,</span><span class="token number">1500</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span><span class="token string">&quot;hupeng&quot;</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span><span class="token string">&quot;lixiang&quot;</span><span class="token punctuation">,</span><span class="token number">4500</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span><span class="token string">&quot;lixiang&quot;</span><span class="token punctuation">,</span><span class="token number">11500</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span><span class="token string">&quot;weishangyin&quot;</span><span class="token punctuation">,</span><span class="token number">4500</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">HandleFeeRequest</span><span class="token punctuation">(</span><span class="token string">&quot;weishangyin&quot;</span><span class="token punctuation">,</span><span class="token number">11500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_14-command-命令模式"><a href="#_14-command-命令模式" class="header-anchor">#</a> 14. COMMAND 命令模式</h2> <p>命令模式：命令模式把一个请求或者操作封装到一个对象中。命令模式把发出命令的责任和执行命令的责任分割开，委派给不同的对象。命令模式允许请求的一方和发送的一方独立开来，使得请求的一方不必知道接收请求的一方的接口，更不必知道请求是怎么被接收，以及操作是否执行，何时被执行以及是怎么被执行的。系统支持命令的撤消。</p> <p>俺有一个MM家里管得特别严，没法见面，只好借助于她弟弟在我们俩之间传送信息，她对我有什么指示，就写一张纸条让她弟弟带给我。这不，她弟弟又传送过来一个COMMAND，为了感谢他，我请他吃了碗杂酱面，哪知道他说：“我同时给我姐姐三个男朋友送COMMAND，就数你最小气，才请我吃面。”</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> test
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Box <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Washclothes Command
	WarmBed Command
<span class="token punctuation">}</span>

<span class="token keyword">func</span>  <span class="token function">NewBox</span><span class="token punctuation">(</span>Washclothes <span class="token punctuation">,</span>WarmBed Command<span class="token punctuation">)</span> <span class="token operator">*</span>Box<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>Box<span class="token punctuation">{</span>Washclothes <span class="token punctuation">,</span>WarmBed<span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">func</span> <span class="token punctuation">(</span> b<span class="token operator">*</span>Box <span class="token punctuation">)</span><span class="token function">GoWashclothes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;给妹子买了一束花&quot;</span><span class="token punctuation">)</span>
	b<span class="token punctuation">.</span>Washclothes<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span> b<span class="token operator">*</span>Box <span class="token punctuation">)</span><span class="token function">GoWarmBed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;给妹子买了一个iphone max&quot;</span><span class="token punctuation">)</span>
	b<span class="token punctuation">.</span>WarmBed<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------------</span>
<span class="token keyword">type</span> Command <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//执行</span>
<span class="token punctuation">}</span>

<span class="token comment">//-----------------------------------------</span>
<span class="token keyword">type</span> MMCommand1 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	mb<span class="token operator">*</span>MotherBoard
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewMMCommand1</span><span class="token punctuation">(</span>mb <span class="token operator">*</span>MotherBoard<span class="token punctuation">)</span><span class="token operator">*</span>MMCommand1<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>MMCommand1<span class="token punctuation">{</span>mb<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>mmc1 MMCommand1 <span class="token punctuation">)</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	mmc1<span class="token punctuation">.</span>mb<span class="token punctuation">.</span><span class="token function">WashClothes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//洗衣服</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------------</span>
<span class="token keyword">type</span> MMCommand2 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	mb<span class="token operator">*</span>MotherBoard
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewMMCommand2</span><span class="token punctuation">(</span>mb <span class="token operator">*</span>MotherBoard<span class="token punctuation">)</span><span class="token operator">*</span>MMCommand2<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>MMCommand2<span class="token punctuation">{</span>mb<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>mmc1 MMCommand2 <span class="token punctuation">)</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	mmc1<span class="token punctuation">.</span>mb<span class="token punctuation">.</span><span class="token function">Warmbed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//洗衣服</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------------</span>
<span class="token keyword">type</span> MotherBoard <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>MotherBoard<span class="token punctuation">)</span><span class="token function">WashClothes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;委派妹子去洗衣服了&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>MotherBoard<span class="token punctuation">)</span><span class="token function">Warmbed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;委派妹子去暖床了&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//-----------------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main9</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	mb<span class="token operator">:=</span><span class="token operator">&amp;</span>MotherBoard<span class="token punctuation">{</span><span class="token punctuation">}</span>
	cmd1<span class="token operator">:=</span><span class="token function">NewMMCommand1</span><span class="token punctuation">(</span>mb<span class="token punctuation">)</span>
	cmd2<span class="token operator">:=</span><span class="token function">NewMMCommand2</span><span class="token punctuation">(</span>mb<span class="token punctuation">)</span>

	box1<span class="token operator">:=</span><span class="token function">NewBox</span><span class="token punctuation">(</span>cmd1<span class="token punctuation">,</span>cmd2<span class="token punctuation">)</span>
	box1<span class="token punctuation">.</span><span class="token function">GoWarmBed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	box1<span class="token punctuation">.</span><span class="token function">GoWashclothes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//box2:=NewBox(cmd1,cmd2)</span>
	<span class="token comment">//box2.GoWarmBed()</span>
	<span class="token comment">//box2.GoWashclothes()</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_15-interpreter-解释器模式"><a href="#_15-interpreter-解释器模式" class="header-anchor">#</a> 15. INTERPRETER 解释器模式</h2> <p>解释器模式：给定一个语言后，解释器模式可以定义出其文法的一种表示，并同时提供一个解释器。客户端可以使用这个解释器来解释这个语言中的句子。解释器模式将描述怎样在有了一个简单的文法后，使用模式设计解释这些语句。在解释器模式里面提到的语言是指任何解释器对象能够解释的任何组合。在解释器模式中需要定义一个代表文法的命令类的等级结构，也就是一系列的组合规则。每一个命令对象都有一个解释方法，代表对命令对象的解释。命令对象的等级结构中的对象的任何排列组合都是一个语言。</p> <p>俺有一个《泡MM真经》，上面有各种泡MM的攻略，比如说去吃西餐的步骤、去看电影的方法等等，跟MM约会时，只要做一个Interpreter，照着上面的脚本执行就可以了。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> test

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;strconv&quot;</span>
	<span class="token string">&quot;strings&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> AddNode <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	left<span class="token punctuation">,</span>right Node
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>AddNode<span class="token punctuation">)</span><span class="token function">Interpret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> a<span class="token punctuation">.</span>left<span class="token punctuation">.</span><span class="token function">Interpret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>a<span class="token punctuation">.</span>right<span class="token punctuation">.</span><span class="token function">Interpret</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//------------------------------------</span>
<span class="token comment">//节点，返回一个数据</span>
<span class="token keyword">type</span> Node <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	Interpret <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> ValNode <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	val <span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>valn <span class="token operator">*</span>ValNode<span class="token punctuation">)</span>Interpret <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> valn<span class="token punctuation">.</span>val
<span class="token punctuation">}</span>
<span class="token comment">//------------------------------------</span>
<span class="token keyword">type</span> Parser <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	exp <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
	index <span class="token builtin">int</span>
	prev Node
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p<span class="token operator">*</span>Parser<span class="token punctuation">)</span><span class="token function">Parse</span><span class="token punctuation">(</span>exp <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	p<span class="token punctuation">.</span>exp<span class="token operator">=</span>strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>exp<span class="token punctuation">,</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> p<span class="token punctuation">.</span>index <span class="token operator">&gt;=</span> <span class="token function">len</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>exp<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">switch</span> p<span class="token punctuation">.</span>exp<span class="token punctuation">[</span>p<span class="token punctuation">.</span>index<span class="token punctuation">]</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token string">&quot;+&quot;</span><span class="token punctuation">:</span>
			p<span class="token punctuation">.</span>prev<span class="token operator">=</span>p<span class="token punctuation">.</span><span class="token function">newAddNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">case</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">:</span>
			p<span class="token punctuation">.</span>prev<span class="token operator">=</span>p<span class="token punctuation">.</span><span class="token function">newSubNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">default</span><span class="token punctuation">:</span>
			p<span class="token punctuation">.</span>prev<span class="token operator">=</span>p<span class="token punctuation">.</span><span class="token function">newValNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>p<span class="token operator">*</span>Parser<span class="token punctuation">)</span><span class="token function">newAddNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Node<span class="token punctuation">{</span>
	p<span class="token punctuation">.</span>index<span class="token operator">++</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>AddNode<span class="token punctuation">{</span>p<span class="token punctuation">.</span>prev<span class="token punctuation">,</span>p<span class="token punctuation">.</span><span class="token function">newValNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p<span class="token operator">*</span>Parser<span class="token punctuation">)</span><span class="token function">newSubNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Node<span class="token punctuation">{</span>
	p<span class="token punctuation">.</span>index<span class="token operator">++</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>SubNode<span class="token punctuation">{</span>p<span class="token punctuation">.</span>prev<span class="token punctuation">,</span>p<span class="token punctuation">.</span><span class="token function">newValNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p<span class="token operator">*</span>Parser<span class="token punctuation">)</span><span class="token function">newValNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Node<span class="token punctuation">{</span>
	v<span class="token punctuation">,</span><span class="token boolean">_</span><span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">Atoi</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>exp<span class="token punctuation">[</span>p<span class="token punctuation">.</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//转换类型</span>
	p<span class="token punctuation">.</span>index<span class="token operator">++</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>ValNode<span class="token punctuation">{</span>v<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p<span class="token operator">*</span>Parser<span class="token punctuation">)</span> <span class="token function">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Node<span class="token punctuation">{</span>
	<span class="token keyword">return</span> p<span class="token punctuation">.</span>prev
<span class="token punctuation">}</span>
<span class="token comment">//------------------------------------</span>
<span class="token keyword">type</span> SubNode <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	left<span class="token punctuation">,</span>right Node
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>SubNode<span class="token punctuation">)</span><span class="token function">Interpret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> a<span class="token punctuation">.</span>left<span class="token punctuation">.</span><span class="token function">Interpret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>a<span class="token punctuation">.</span>right<span class="token punctuation">.</span><span class="token function">Interpret</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//------------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//1+2</span>
	<span class="token comment">//1+2+3</span>
	<span class="token comment">//1+2+3+5-4</span>
	p <span class="token operator">:=</span><span class="token operator">&amp;</span>Parser<span class="token punctuation">{</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;start\n&quot;</span><span class="token punctuation">)</span>
	p<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token string">&quot;1 + 3 - 2 + 5 - 6 + 7 - 10&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Interpret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_16-iterator-迭代子模式"><a href="#_16-iterator-迭代子模式" class="header-anchor">#</a> 16. ITERATOR 迭代子模式</h2> <p>迭代子模式：迭代子模式可以顺序访问一个聚集中的元素而不必暴露聚集的内部表象。多个对象聚在一起形成的总体称之为聚集，聚集对象是能够包容一组对象的容器对象。迭代子模式将迭代逻辑封装到一个独立的子对象中，从而与聚集本身隔开。迭代子模式简化了聚集的界面。每一个聚集对象都可以有一个或一个以上的迭代子对象，每一个迭代子的迭代状态可以是彼此独立的。迭代算法可以独立于聚集角色变化。</p> <p>我爱上了Mary，不顾一切的向她求婚。Mary：“想要我跟你结婚，得答应我的条件” 我：“什么条件我都答应，你说吧” Mary：“我看上了那个一克拉的钻石” 我：“我买，我买，还有吗？” Mary：“我看上了湖边的那栋别墅” 我：“我买，我买，还有吗？” Mary：“我看上那辆法拉利跑车” 我脑袋嗡的一声，坐在椅子上，一咬牙：“我买，我买，还有吗？” ……</p> <div class="language-go extra-class"><pre class="language-go"><code>
</code></pre></div><h2 id="_17-mediator-调停者模式"><a href="#_17-mediator-调停者模式" class="header-anchor">#</a> 17. MEDIATOR 调停者模式</h2> <p>调停者模式：调停者模式包装了一系列对象相互作用的方式，使得这些对象不必相互明显作用。从而使他们可以松散偶合。当某些对象之间的作用发生改变时，不会立即影响其他的一些对象之间的作用。保证这些作用可以彼此独立的变化。调停者模式将多对多的相互作用转化为一对多的相互作用。调停者模式将对象的行为和协作抽象化，把对象在小尺度的行为上与其他对象的相互作用分开处理。</p> <p>四个MM打麻将，相互之间谁应该给谁多少钱算不清楚了，幸亏当时我在旁边，按照各自的筹码数算钱，赚了钱的从我这里拿，赔了钱的也付给我，一切就OK啦，俺得到了四个MM的电话。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> test
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">type</span>  CPU <span class="token keyword">struct</span><span class="token punctuation">{</span>
	data <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c<span class="token operator">*</span>CPU<span class="token punctuation">)</span> <span class="token function">Process</span><span class="token punctuation">(</span>data <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;CPU is running &quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>

<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------</span>
<span class="token keyword">type</span>  Disk <span class="token keyword">struct</span><span class="token punctuation">{</span>
	data <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>d <span class="token operator">*</span> Disk<span class="token punctuation">)</span><span class="token function">Store</span><span class="token punctuation">(</span>data <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;disk is running &quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------</span>
<span class="token keyword">type</span>  GPU <span class="token keyword">struct</span><span class="token punctuation">{</span>
	data <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>g <span class="token operator">*</span>GPU<span class="token punctuation">)</span><span class="token function">Display</span><span class="token punctuation">(</span>data <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;GPU is running &quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------</span>

<span class="token keyword">type</span> MediatorX <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Ccpu <span class="token operator">*</span>CPU
	Cgpu <span class="token operator">*</span>GPU
	Cdisk <span class="token operator">*</span>Disk
	Cmem <span class="token operator">*</span>MEM
<span class="token punctuation">}</span>
<span class="token keyword">var</span> mediator <span class="token operator">*</span> MediatorX<span class="token operator">=</span><span class="token boolean">nil</span>

<span class="token keyword">func</span> <span class="token function">GetMediatorInstace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>MediatorX<span class="token punctuation">{</span>
	<span class="token keyword">if</span> mediator<span class="token operator">==</span><span class="token boolean">nil</span><span class="token punctuation">{</span>
		mediator<span class="token operator">=</span><span class="token operator">&amp;</span>MediatorX<span class="token punctuation">{</span><span class="token boolean">nil</span><span class="token punctuation">,</span><span class="token boolean">nil</span><span class="token punctuation">,</span><span class="token boolean">nil</span><span class="token punctuation">,</span><span class="token boolean">nil</span><span class="token punctuation">}</span>
		mediator<span class="token punctuation">.</span>Ccpu<span class="token operator">=</span><span class="token operator">&amp;</span>CPU<span class="token punctuation">{</span><span class="token punctuation">}</span>
		mediator<span class="token punctuation">.</span>Cgpu<span class="token operator">=</span><span class="token operator">&amp;</span>GPU<span class="token punctuation">{</span><span class="token punctuation">}</span>
		mediator<span class="token punctuation">.</span>Cmem<span class="token operator">=</span><span class="token operator">&amp;</span>MEM<span class="token punctuation">{</span><span class="token punctuation">}</span>
		mediator<span class="token punctuation">.</span>Cdisk<span class="token operator">=</span><span class="token operator">&amp;</span>Disk<span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> mediator
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m<span class="token operator">*</span>MediatorX<span class="token punctuation">)</span><span class="token function">Changed</span><span class="token punctuation">(</span>i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">switch</span> inst<span class="token operator">:=</span>i<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token operator">*</span>CPU<span class="token punctuation">:</span>
		m<span class="token punctuation">.</span>Ccpu<span class="token punctuation">.</span><span class="token function">Process</span><span class="token punctuation">(</span>inst<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token operator">*</span>GPU<span class="token punctuation">:</span>
		m<span class="token punctuation">.</span>Cgpu<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span>inst<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token operator">*</span>Disk<span class="token punctuation">:</span>
		m<span class="token punctuation">.</span>Cdisk<span class="token punctuation">.</span><span class="token function">Store</span><span class="token punctuation">(</span>inst<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token operator">*</span>MEM<span class="token punctuation">:</span>
		m<span class="token punctuation">.</span>Cmem<span class="token punctuation">.</span><span class="token function">Dump</span><span class="token punctuation">(</span>inst<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>

	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------</span>
<span class="token keyword">type</span>  MEM <span class="token keyword">struct</span><span class="token punctuation">{</span>
	data <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m<span class="token operator">*</span>MEM<span class="token punctuation">)</span><span class="token function">Dump</span><span class="token punctuation">(</span>data <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;MEM is running &quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	meditor<span class="token operator">:=</span><span class="token function">GetMediatorInstace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>meditor<span class="token punctuation">)</span>
	meditor<span class="token punctuation">.</span>Ccpu<span class="token punctuation">.</span><span class="token function">Process</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
	meditor<span class="token punctuation">.</span>Cgpu<span class="token punctuation">.</span><span class="token function">Display</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
	meditor<span class="token punctuation">.</span>Cdisk<span class="token punctuation">.</span><span class="token function">Store</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
	meditor<span class="token punctuation">.</span>Cmem<span class="token punctuation">.</span><span class="token function">Dump</span><span class="token punctuation">(</span><span class="token string">&quot;gogogo&quot;</span><span class="token punctuation">)</span>
	meditor<span class="token punctuation">.</span><span class="token function">Changed</span><span class="token punctuation">(</span>meditor<span class="token punctuation">.</span>Ccpu<span class="token punctuation">)</span>
	meditor<span class="token punctuation">.</span><span class="token function">Changed</span><span class="token punctuation">(</span>meditor<span class="token punctuation">.</span>Cmem<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_18-memento-备忘录模式"><a href="#_18-memento-备忘录模式" class="header-anchor">#</a> 18. MEMENTO 备忘录模式</h2> <p>备忘录模式：备忘录对象是一个用来存储另外一个对象内部状态的快照的对象。备忘录模式的用意是在不破坏封装的条件下，将一个对象的状态捉住，并外部化，存储起来，从而可以在将来合适的时候把这个对象还原到存储起来的状态。</p> <p>同时跟几个MM聊天时，一定要记清楚刚才跟MM说了些什么话，不然MM发现了会不高兴的哦，幸亏我有个备忘录，刚才与哪个MM说了什么话我都拷贝一份放到备忘录里面保存，这样可以随时察看以前的记录啦。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> MEMENTO

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> MMfeel <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Tall <span class="token builtin">int</span>
	Rich <span class="token builtin">int</span>
	Handsome <span class="token builtin">int</span>
<span class="token punctuation">}</span>


<span class="token keyword">var</span> States <span class="token punctuation">[</span><span class="token punctuation">]</span>MMfeel<span class="token operator">=</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>MMfeel<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> Stateslength <span class="token builtin">int</span> <span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mmf<span class="token operator">*</span>MMfeel<span class="token punctuation">)</span>A第一次见面<span class="token punctuation">(</span>tall <span class="token builtin">int</span><span class="token punctuation">,</span>rich <span class="token builtin">int</span><span class="token punctuation">,</span>handsome <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	mmf<span class="token punctuation">.</span>Tall<span class="token operator">=</span>tall
	mmf<span class="token punctuation">.</span>Rich<span class="token operator">=</span>rich
	mmf<span class="token punctuation">.</span>Handsome<span class="token operator">=</span>handsome
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;当前状态&quot;</span><span class="token punctuation">,</span>mmf<span class="token punctuation">.</span>Tall<span class="token punctuation">,</span>mmf<span class="token punctuation">.</span>Rich<span class="token punctuation">,</span>mmf<span class="token punctuation">.</span>Handsome<span class="token punctuation">)</span>
	States<span class="token operator">=</span><span class="token function">append</span><span class="token punctuation">(</span>States<span class="token punctuation">,</span><span class="token operator">*</span>mmf<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mmf<span class="token operator">*</span>MMfeel<span class="token punctuation">)</span>A去韩国<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	mmf<span class="token punctuation">.</span>Handsome <span class="token operator">=</span>mmf<span class="token punctuation">.</span>Handsome<span class="token operator">+</span><span class="token number">30</span>
	States<span class="token operator">=</span><span class="token function">append</span><span class="token punctuation">(</span>States<span class="token punctuation">,</span><span class="token operator">*</span>mmf<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mmf<span class="token operator">*</span>MMfeel<span class="token punctuation">)</span>A中彩票<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	mmf<span class="token punctuation">.</span>Rich<span class="token operator">+=</span><span class="token number">5000000</span>
	States<span class="token operator">=</span><span class="token function">append</span><span class="token punctuation">(</span>States<span class="token punctuation">,</span><span class="token operator">*</span>mmf<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mmf<span class="token operator">*</span>MMfeel<span class="token punctuation">)</span>A断腿骨<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	mmf<span class="token punctuation">.</span>Tall<span class="token operator">+=</span><span class="token number">10</span>
	States<span class="token operator">=</span><span class="token function">append</span><span class="token punctuation">(</span>States<span class="token punctuation">,</span><span class="token operator">*</span>mmf<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mmf<span class="token operator">*</span>MMfeel<span class="token punctuation">)</span>A妹子的分数<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;当前状态&quot;</span><span class="token punctuation">,</span>mmf<span class="token punctuation">.</span>Tall<span class="token punctuation">,</span>mmf<span class="token punctuation">.</span>Rich<span class="token punctuation">,</span>mmf<span class="token punctuation">.</span>Handsome<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> xiaoxianglong <span class="token operator">*</span>MMfeel<span class="token operator">=</span><span class="token operator">&amp;</span>MMfeel<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span>
	xiaoxianglong<span class="token punctuation">.</span>A第一次见面<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span><span class="token number">500000</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">)</span>
	xiaoxianglong<span class="token punctuation">.</span>A中彩票<span class="token punctuation">(</span><span class="token punctuation">)</span>
	xiaoxianglong<span class="token punctuation">.</span>A去韩国<span class="token punctuation">(</span><span class="token punctuation">)</span>
	xiaoxianglong<span class="token punctuation">.</span>A断腿骨<span class="token punctuation">(</span><span class="token punctuation">)</span>
	xiaoxianglong<span class="token punctuation">.</span>A妹子的分数<span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>States<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_19-observer-观察者模式"><a href="#_19-observer-观察者模式" class="header-anchor">#</a> 19. OBSERVER 观察者模式</h2> <p>观察者模式：观察者模式定义了一种一队多的依赖关系，让多个观察者对象同时监听某一个主题对象。这个主题对象在状态上发生变化时，会通知所有观察者对象，使他们能够自动更新自己。</p> <p>想知道咱们公司**MM情报吗？加入公司的MM情报邮件组就行了，tom负责搜集情报，他发现的新情报不用一个一个通知我们，直接发布给邮件组，我们作为订阅者（观察者）就可以及时收到情报啦。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> test

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">type</span> Observer <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Update</span><span class="token punctuation">(</span>subject <span class="token operator">*</span>Subject<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------</span>
<span class="token comment">//读取类</span>
<span class="token keyword">type</span> Reader <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewReader</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">*</span>Reader<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>Reader<span class="token punctuation">{</span>name<span class="token punctuation">:</span>name<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Reader<span class="token punctuation">)</span><span class="token function">Update</span><span class="token punctuation">(</span>subject <span class="token operator">*</span>Subject<span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s 收到 %s\n&quot;</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>name<span class="token punctuation">,</span>subject<span class="token punctuation">.</span>context<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------</span>

<span class="token keyword">type</span>  Subject <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	obs  <span class="token punctuation">[</span><span class="token punctuation">]</span> Observer  <span class="token comment">//群聊</span>
	context <span class="token builtin">string</span>   <span class="token comment">//更新群聊的信息</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> NewSubject <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>Subject<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>Subject<span class="token punctuation">{</span>obs<span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>Observer<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s<span class="token operator">*</span> Subject<span class="token punctuation">)</span><span class="token function">Attch</span><span class="token punctuation">(</span>o Observer<span class="token punctuation">)</span><span class="token punctuation">{</span>
	s<span class="token punctuation">.</span>obs<span class="token operator">=</span><span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>obs<span class="token punctuation">,</span>o<span class="token punctuation">)</span><span class="token comment">//加入群聊</span>
<span class="token punctuation">}</span>



<span class="token keyword">func</span> <span class="token punctuation">(</span>s<span class="token operator">*</span> Subject<span class="token punctuation">)</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span>o<span class="token operator">:=</span><span class="token keyword">range</span> s<span class="token punctuation">.</span>obs<span class="token punctuation">{</span><span class="token comment">//每个人都发一次</span>
		o<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>  <span class="token comment">//更新通知</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s<span class="token operator">*</span> Subject<span class="token punctuation">)</span><span class="token function">UpdateContext</span><span class="token punctuation">(</span>context <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	s<span class="token punctuation">.</span>context<span class="token operator">=</span>context
	s<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//更新之后通知</span>
<span class="token punctuation">}</span>

<span class="token comment">//---------------------------------------</span>

<span class="token keyword">func</span> <span class="token function">main2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	subject<span class="token operator">:=</span><span class="token function">NewSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	r1<span class="token operator">:=</span><span class="token function">NewReader</span><span class="token punctuation">(</span><span class="token string">&quot;lixiang&quot;</span><span class="token punctuation">)</span>
	r2<span class="token operator">:=</span><span class="token function">NewReader</span><span class="token punctuation">(</span><span class="token string">&quot;hupeng&quot;</span><span class="token punctuation">)</span>
	r3<span class="token operator">:=</span><span class="token function">NewReader</span><span class="token punctuation">(</span><span class="token string">&quot;zhangbo&quot;</span><span class="token punctuation">)</span>
	subject<span class="token punctuation">.</span><span class="token function">Attch</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span>
	subject<span class="token punctuation">.</span><span class="token function">Attch</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span>
	subject<span class="token punctuation">.</span><span class="token function">Attch</span><span class="token punctuation">(</span>r3<span class="token punctuation">)</span>
	subject<span class="token punctuation">.</span><span class="token function">UpdateContext</span><span class="token punctuation">(</span><span class="token string">&quot;妹子来了&quot;</span><span class="token punctuation">)</span>
	r4<span class="token operator">:=</span><span class="token function">NewReader</span><span class="token punctuation">(</span><span class="token string">&quot;yangjie&quot;</span><span class="token punctuation">)</span>
	subject<span class="token punctuation">.</span><span class="token function">Attch</span><span class="token punctuation">(</span>r4<span class="token punctuation">)</span>
	subject<span class="token punctuation">.</span><span class="token function">UpdateContext</span><span class="token punctuation">(</span><span class="token string">&quot;漂亮妹子来了&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_20-state-状态模式"><a href="#_20-state-状态模式" class="header-anchor">#</a> 20. STATE 状态模式</h2> <p>状态模式：状态模式允许一个对象在其内部状态改变的时候改变行为。这个对象看上去象是改变了它的类一样。状态模式把所研究的对象的行为包装在不同的状态对象里，每一个状态对象都属于一个抽象状态类的一个子类。状态模式的意图是让一个对象在其内部状态改变的时候，其行为也随之改变。状态模式需要对每一个系统可能取得的状态创立一个状态类的子类。当系统的状态变化时，系统便改变所选的子类。</p> <p>跟MM交往时，一定要注意她的状态哦，在不同的状态时她的行为会有不同，比如你约她今天晚上去看电影，对你没兴趣的MM就会说“有事情啦”，对你不讨厌但还没喜欢上的MM就会说“好啊，不过可以带上我同事么？”，已经喜欢上你的MM就会说“几点钟？看完电影再去泡吧怎么样？”，当然你看电影过程中表现良好的话，也可以把MM的状态从不讨厌不喜欢变成喜欢哦。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> test

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Sunday <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span>Sunday<span class="token punctuation">)</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Sunday\n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span>Sunday<span class="token punctuation">)</span><span class="token function">Next</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>DayContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>today<span class="token operator">=</span><span class="token operator">&amp;</span>Monday<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Monday <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Monday<span class="token punctuation">)</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot; Monday\n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Monday<span class="token punctuation">)</span><span class="token function">Next</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>DayContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>today<span class="token operator">=</span><span class="token operator">&amp;</span>Tuesday <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Tuesday <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span>  Tuesday<span class="token punctuation">)</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot; Monday\n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span>  Tuesday<span class="token punctuation">)</span><span class="token function">Next</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>DayContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>today<span class="token operator">=</span><span class="token operator">&amp;</span>Wednesday <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Wednesday  <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Wednesday <span class="token punctuation">)</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot; Wednesday \n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Wednesday <span class="token punctuation">)</span><span class="token function">Next</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>DayContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>today<span class="token operator">=</span><span class="token operator">&amp;</span>Thursday <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Thursday <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Thursday<span class="token punctuation">)</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot; Thursday\n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Thursday<span class="token punctuation">)</span><span class="token function">Next</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>DayContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>today<span class="token operator">=</span><span class="token operator">&amp;</span> Friday <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Friday <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Friday<span class="token punctuation">)</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot; Friday\n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Friday<span class="token punctuation">)</span><span class="token function">Next</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>DayContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>today<span class="token operator">=</span><span class="token operator">&amp;</span> Saturday <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Saturday <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Saturday<span class="token punctuation">)</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot; Saturday\n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>sd <span class="token operator">*</span> Saturday<span class="token punctuation">)</span><span class="token function">Next</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>DayContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>today<span class="token operator">=</span><span class="token operator">&amp;</span> Sunday <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//------------------------------------------</span>

<span class="token comment">//每个星期行为</span>
<span class="token keyword">type</span> Week <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">Next</span><span class="token punctuation">(</span><span class="token operator">*</span>DayContext <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//星期数据结构</span>
<span class="token keyword">type</span> DayContext <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	today Week
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewDayContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>DayContext<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>DayContext<span class="token punctuation">{</span><span class="token operator">&amp;</span>Sunday<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span> dc<span class="token operator">*</span>DayContext<span class="token punctuation">)</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	dc<span class="token punctuation">.</span>today<span class="token punctuation">.</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//今天</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span> dc<span class="token operator">*</span>DayContext<span class="token punctuation">)</span><span class="token function">Next</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
	dc<span class="token punctuation">.</span>today<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span>dc<span class="token punctuation">)</span><span class="token comment">//m明天</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	ctx<span class="token operator">:=</span><span class="token function">NewDayContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	todayAndNext <span class="token operator">:=</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span><span class="token function">Today</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> i<span class="token operator">:=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">98</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">{</span>
		<span class="token function">todayAndNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="_21-strategy-策略模式"><a href="#_21-strategy-策略模式" class="header-anchor">#</a> 21. STRATEGY 策略模式</h2> <p>策略模式：<strong>策略模式针对一组算法，将每一个算法封装到具有共同接口的独立的类中</strong>，从而使得它们可以相互替换。策略模式使得算法可以在不影响到客户端的情况下发生变化。策略模把行为和环境分开。环境类负责维持和查询行为类，各种算法在具体的策略类中提供。由于算法和环境独立开来，算法的增减，修改都不会影响到环境和客户端。</p> <p>跟不同类型的MM约会，要用不同的策略，有的请电影比较好，有的则去吃小吃效果不错，有的去海边浪漫最合适，单目的都是为了得到MM的芳心，我的追MM锦囊中有好多Strategy哦。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> Strategy

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> MMContext <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Name <span class="token builtin">string</span>
	Age  <span class="token builtin">int</span>
	paoStrategy  MMStrategy
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewMMContext</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span>age <span class="token builtin">int</span><span class="token punctuation">,</span>mms MMStrategy<span class="token punctuation">)</span><span class="token operator">*</span>MMContext<span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>MMContext<span class="token punctuation">{</span>name<span class="token punctuation">,</span>age <span class="token punctuation">,</span>mms<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mm <span class="token operator">*</span>MMContext<span class="token punctuation">)</span><span class="token function">Pao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	mm<span class="token punctuation">.</span>paoStrategy<span class="token punctuation">.</span><span class="token function">Pao</span><span class="token punctuation">(</span>mm<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> MMStrategy <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Pao</span><span class="token punctuation">(</span><span class="token operator">*</span>MMContext<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Girl <span class="token keyword">struct</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>Girl<span class="token punctuation">)</span><span class="token function">Pao</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>MMContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;带妹子去看遍世间繁华&quot;</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Women <span class="token keyword">struct</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>Women<span class="token punctuation">)</span><span class="token function">Pao</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>MMContext<span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;带大妈取做旋转木马&quot;</span><span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main7</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//ctx:=Strategy.NewMMContext(&quot;marry&quot;,18,&amp;Strategy.Girl{})</span>
	ctx<span class="token operator">:=</span><span class="token function">NewMMContext</span><span class="token punctuation">(</span><span class="token string">&quot;alis&quot;</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>Strategy<span class="token punctuation">.</span>Women<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">//if age&lt;18  facotry</span>

	ctx<span class="token punctuation">.</span><span class="token function">Pao</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_22-template-method-模板模式"><a href="#_22-template-method-模板模式" class="header-anchor">#</a> 22. TEMPLATE METHOD 模板模式</h2> <p>模板方法模式：模板方法模式准备一个抽象类，将部分逻辑以具体方法以及具体构造子的形式实现，然后声明一些抽象方法来迫使子类实现剩余的逻辑。不同的子类可以以不同的方式实现这些抽象方法，从而对剩余的逻辑有不同的实现。先制定一个珠峰逻辑框架，而将逻辑的细节留给具体的子类去实现。</p> <p>看过《如何说服女生上床》这部经典文章吗？女生从认识到上床的不变的步骤分为巧遇、打破僵局、展开追求、接吻、前戏、动手、爱抚、进去八大步骤(Template method)，但每个步骤针对不同的情况，都有不一样的做法，这就要看你随机应变啦(具体实现)。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> Template

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Downloader <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Download</span><span class="token punctuation">(</span>url <span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span>  template <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	implement
	url  <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> implement <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">Newtemplate</span><span class="token punctuation">(</span>impl implement<span class="token punctuation">)</span><span class="token operator">*</span>template  <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>template<span class="token punctuation">{</span>impl<span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span> template<span class="token punctuation">)</span><span class="token function">Download</span><span class="token punctuation">(</span>url <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;模板下载start&quot;</span><span class="token punctuation">)</span>
	t<span class="token punctuation">.</span>url<span class="token operator">=</span>url
	t<span class="token punctuation">.</span>implement<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	t<span class="token punctuation">.</span>implement<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;模板下载end&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span> template<span class="token punctuation">)</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;模板下载保存&quot;</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>
<span class="token comment">//------------------------------------------------</span>
<span class="token keyword">type</span>  FtpDownLoader <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token operator">*</span>template
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewFtpDownLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Downloader<span class="token punctuation">{</span>
	downloader<span class="token operator">:=</span><span class="token operator">&amp;</span>FtpDownLoader<span class="token punctuation">{</span><span class="token punctuation">}</span>
	template<span class="token operator">:=</span><span class="token function">Newtemplate</span><span class="token punctuation">(</span>downloader<span class="token punctuation">)</span>
	downloader<span class="token punctuation">.</span>template<span class="token operator">=</span>template
	<span class="token keyword">return</span> downloader
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>hd<span class="token operator">*</span>FtpDownLoader<span class="token punctuation">)</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;ftp down %s \n&quot;</span><span class="token punctuation">,</span>hd<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>hd<span class="token operator">*</span>FtpDownLoader<span class="token punctuation">)</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;ftp save %s \n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//------------------------------------------------</span>

<span class="token keyword">type</span>  HttpDownLoader <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token operator">*</span>template
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewHttpDownLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Downloader<span class="token punctuation">{</span>
	downloader<span class="token operator">:=</span><span class="token operator">&amp;</span>HttpDownLoader<span class="token punctuation">{</span><span class="token punctuation">}</span>
	template<span class="token operator">:=</span><span class="token function">Newtemplate</span><span class="token punctuation">(</span>downloader<span class="token punctuation">)</span>
	downloader<span class="token punctuation">.</span>template<span class="token operator">=</span>template
	<span class="token keyword">return</span> downloader
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>hd<span class="token operator">*</span>HttpDownLoader<span class="token punctuation">)</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;http down %s \n&quot;</span><span class="token punctuation">,</span>hd<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>hd<span class="token operator">*</span>HttpDownLoader<span class="token punctuation">)</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;http save \n&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//------------------------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span>  downloader Downloader<span class="token operator">=</span><span class="token function">NewHttpDownLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	downloader<span class="token punctuation">.</span><span class="token function">Download</span><span class="token punctuation">(</span><span class="token string">&quot;http://tsinghua.edu.cn/ai.zip&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span>  downloader1 Downloader<span class="token operator">=</span><span class="token function">NewFtpDownLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	downloader1<span class="token punctuation">.</span><span class="token function">Download</span><span class="token punctuation">(</span><span class="token string">&quot;ftp://tsinghua.edu.cn/ai.zip&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_23-visitor-访问者模式"><a href="#_23-visitor-访问者模式" class="header-anchor">#</a> 23. VISITOR 访问者模式</h2> <p>访问者模式：访问者模式的目的是封装一些施加于某种数据结构元素之上的操作。一旦这些操作需要修改的话，接受这个操作的数据结构可以保持不变。访问者模式适用于数据结构相对未定的系统，它把数据结构和作用于结构上的操作之间的耦合解脱开，使得操作集合可以相对自由的演化。访问者模式使得增加新的操作变的很容易，就是增加一个新的访问者类。访问者模式将有关的行为集中到一个访问者对象中，而不是分散到一个个的节点类中。当使用访问者模式时，要将尽可能多的对象浏览逻辑放在访问者类中，而不是放到它的子类中。访问者模式可以跨过几个类的等级结构访问属于不同的等级结构的成员类。</p> <p>情人节到了，要给每个MM送一束鲜花和一张卡片，可是每个MM送的花都要针对她个人的特点，每张卡片也要根据个人的特点来挑，我一个人哪搞得清楚，还是找花店老板和礼品店老板做一下Visitor，让花店老板根据MM的特点选一束花，让礼品店老板也根据每个人特点选一张卡，这样就轻松多了。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> test
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> AnalysisVisitor <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span> AnalysisVisitor <span class="token punctuation">)</span><span class="token function">Visit</span><span class="token punctuation">(</span>customer Customer<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">switch</span> c<span class="token operator">:=</span>customer<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token operator">*</span> EnterpriseCustomer<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Analysis  Enterprise  customer&quot;</span><span class="token punctuation">,</span>c<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//---------------------------------------------</span>
<span class="token keyword">type</span> Customer <span class="token keyword">interface</span> <span class="token punctuation">{</span> <span class="token comment">//接待者</span>
	<span class="token function">Accept</span><span class="token punctuation">(</span>Visitor <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Visitor <span class="token keyword">interface</span> <span class="token punctuation">{</span><span class="token comment">//访问者</span>
	<span class="token function">Visit</span><span class="token punctuation">(</span>Customer<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------------</span>
<span class="token keyword">type</span> CustomerCol <span class="token keyword">struct</span><span class="token punctuation">{</span>
	customers<span class="token punctuation">[</span><span class="token punctuation">]</span>  Customer  <span class="token comment">//接待者集合</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>CustomerCol<span class="token punctuation">)</span><span class="token function">Add</span><span class="token punctuation">(</span>customer  Customer<span class="token punctuation">)</span><span class="token punctuation">{</span>
	c<span class="token punctuation">.</span>customers<span class="token operator">=</span><span class="token function">append</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>customers<span class="token punctuation">,</span>customer<span class="token punctuation">)</span> <span class="token comment">//叠加</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>CustomerCol<span class="token punctuation">)</span><span class="token function">Accept</span><span class="token punctuation">(</span>visitor Visitor<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//每个服务者，接受访问者</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span>customer <span class="token operator">:=</span> <span class="token keyword">range</span> c<span class="token punctuation">.</span>customers<span class="token punctuation">{</span>
		customer<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span>visitor<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------------</span>
<span class="token keyword">type</span> EnterpriseCustomer <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewEnterpriseCustomer</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">*</span>EnterpriseCustomer<span class="token punctuation">{</span>
	<span class="token keyword">return</span>  <span class="token operator">&amp;</span>EnterpriseCustomer<span class="token punctuation">{</span>name<span class="token punctuation">:</span>name<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>ec <span class="token operator">*</span>EnterpriseCustomer<span class="token punctuation">)</span><span class="token function">Accept</span><span class="token punctuation">(</span>visitor Visitor<span class="token punctuation">)</span><span class="token punctuation">{</span>
	visitor<span class="token punctuation">.</span><span class="token function">Visit</span><span class="token punctuation">(</span>ec<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//---------------------------------------------</span>
<span class="token keyword">type</span> IndividualCustomer <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewIndividualCustomer</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">*</span>IndividualCustomer<span class="token punctuation">{</span>
	<span class="token keyword">return</span>  <span class="token operator">&amp;</span>IndividualCustomer<span class="token punctuation">{</span>name<span class="token punctuation">:</span>name<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>ec <span class="token operator">*</span>IndividualCustomer<span class="token punctuation">)</span><span class="token function">Accept</span><span class="token punctuation">(</span>visitor Visitor<span class="token punctuation">)</span><span class="token punctuation">{</span>
	visitor<span class="token punctuation">.</span><span class="token function">Visit</span><span class="token punctuation">(</span>ec<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//---------------------------------------------</span>
<span class="token keyword">type</span> SerivceRequesttVisitor <span class="token keyword">struct</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span> SerivceRequesttVisitor <span class="token punctuation">)</span><span class="token function">Visit</span><span class="token punctuation">(</span>customer Customer<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">switch</span> c<span class="token operator">:=</span>customer<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token operator">*</span> EnterpriseCustomer<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;serving  Enterprise  customer&quot;</span><span class="token punctuation">,</span>c<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token operator">*</span>IndividualCustomer<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;serving  Individual Customer&quot;</span><span class="token punctuation">,</span>c<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//---------------------------------------------</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	c<span class="token operator">:=</span>CustomerCol<span class="token punctuation">{</span><span class="token punctuation">}</span>
	c<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token function">NewEnterpriseCustomer</span><span class="token punctuation">(</span><span class="token string">&quot;Microsoft&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	c<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token function">NewIndividualCustomer</span><span class="token punctuation">(</span><span class="token string">&quot;billgates&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token function">NewEnterpriseCustomer</span><span class="token punctuation">(</span><span class="token string">&quot;Google&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token comment">//c.Accept(&amp;SerivceRequesttVisitor{} )</span>
	c<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AnalysisVisitor<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="设计模式小结"><a href="#设计模式小结" class="header-anchor">#</a> 设计模式小结</h2> <p>装饰器模式 一个类增加一个功能,不改变原有类的情况增加功能
享元模式 节约内存
责任链模式 根据每个的级别分配不同的权限，向后传或者向前传
观察者模式 一个类发生要通知其他所有的类
解释器模式  解释加减乘除
状态机模式 不同状态来回切换展示不同的行为</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2020年5月9日星期六上午11点01分</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/programming/pattern/" class="prev router-link-active">
        设计模式原则
      </a></span> <!----></p></div>  <!----></main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.930ef16c.js" defer></script><script src="/assets/js/6.a4c4b5d6.js" defer></script><script src="/assets/js/2.1492d491.js" defer></script><script src="/assets/js/44.a3029ae5.js" defer></script><script src="/assets/js/3.90399333.js" defer></script>
  </body>
</html>
