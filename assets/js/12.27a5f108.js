(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{401:function(s,t,e){"use strict";e.r(t);var a=e(24),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h3",{attrs:{id:"_1-概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述"}},[s._v("#")]),s._v(" 1.概述")]),s._v(" "),e("p",[s._v("一个核心转储文件（ core dump file ）中包含程序进程运行时的内存信息和进程状态。它主要用于程序的问题调试，以及在运行过程中理解程序的状态。这些对于我们诊断程序问题原因和分析生产环境中的服务问题有非常大的帮助。")]),s._v(" "),e("p",[e("strong",[s._v("注意")]),s._v(": 接下来的操作都是在Linux系统终端中执行")]),s._v(" "),e("h3",{attrs:{id:"_2-准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-准备"}},[s._v("#")]),s._v(" 2.准备")]),s._v(" "),e("p",[s._v("​    1) 安装 "),e("a",{attrs:{href:"https://github.com/derekparker/delve",target:"_blank",rel:"noopener noreferrer"}},[s._v("delve"),e("OutboundLink")],1),s._v("  ，用来分析 core dump 文件")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("go get github.com/go-delve/delve/cmd/dlv\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#或者")]),s._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/go-delve/delve.git "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GOPATH")]),s._v("/src/github.com/go-delve/delve\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GOPATH")]),s._v("/src/github.com/go-delve/delve\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])])]),e("p",[s._v("​\t2) ulimit -c unlimited， 设置core dump最大容量 为无限制")]),s._v(" "),e("p",[s._v("​\t\t"),e("strong",[s._v("注意")]),s._v(":可能会设置不成功，可查看 https://www.cnblogs.com/qiumingcheng/p/11668423.html")]),s._v(" "),e("p",[s._v("​\t\t"),e("strong",[s._v("永久生效方法")])]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/profile\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -u "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -n "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -d unlimited\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -m unlimited\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -s unlimited\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -t unlimited\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -v unlimited\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("ulimit")]),s._v(" -c unlimited\n\n")])])]),e("p",[s._v("添加后sudo  source /etc/profile 使生效")]),s._v(" "),e("p",[s._v("​\t3)")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置core文件路径")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/home/origin/goCoreDump/core_%e.%p'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /proc/sys/kernel/core_pattern \n")])])]),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  **注意**: core文件路径必须提前创建，并且进程用户有写权限，可以设置成777的权限 \n")])])]),e("p",[s._v("​")]),s._v(" "),e("h3",{attrs:{id:"_3-启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-启动"}},[s._v("#")]),s._v(" 3.启动")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GOTRACEBACK")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("crash "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" ./hello "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])])]),e("h3",{attrs:{id:"_4-分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-分析"}},[s._v("#")]),s._v(" 4.分析")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("dlv core ./hello core.546\n")])])]),e("p",[s._v("进入交互界面后可用命令stack、bt、ls、help查看信息")]),s._v(" "),e("p",[s._v("参考文档:")]),s._v(" "),e("p",[s._v("https://segmentfault.com/a/1190000010684345")]),s._v(" "),e("p",[s._v("https://zhuanlan.zhihu.com/p/62825675")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/golang/go/wiki/CoreDumpDebugging",target:"_blank",rel:"noopener noreferrer"}},[s._v("CoreDumpDebugging"),e("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=n.exports}}]);